

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Model Structure &mdash; HamGNN v2.1 Documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=fd3f3429" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=7902463a" />

  
    <link rel="shortcut icon" href="../_static/logo.png"/>
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=c36237e0"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=faab29de"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="GNN Core Layers" href="gnn_core.html" />
    <link rel="prev" title="HamGNN Parameter Details" href="../user_guide/parameters.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #2980B9" >

          
          
          <a href="../index.html" class="icon icon-home">
            HamGNN_v_2_1
              <img src="../_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../user_guide/index.html">HamGNN User Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/introduction.html">HamGNN Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/introduction.html#key-features">Key Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/introduction.html#application-areas">Application Areas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/introduction.html#latest-developments">Latest Developments</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/installation.html">Environment Configuration and Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/installation.html#python-environment">Python Environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/installation.html#third-party-dft-tool-support">Third-party DFT Tool Support</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/installation.html#openmx">OpenMX</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/installation.html#siesta-honpas">SIESTA/HONPAS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/installation.html#abacus">ABACUS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/installation.html#compiling-openmx-postprocess-and-read-openmx">Compiling <code class="docutils literal notranslate"><span class="pre">openmx_postprocess</span></code> and <code class="docutils literal notranslate"><span class="pre">read_openmx</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/installation.html#hamgnn-installation-steps">HamGNN Installation Steps</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/installation.html#step-one-install-conda-environment">Step One: Install Conda Environment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/installation.html#step-two-source-installation-of-hamgnn">Step Two: Source Installation of HamGNN</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/data_preparation.html">Construction of graph_data.npz File</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/data_preparation.html#general-process">General Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/data_preparation.html#openmx-process">OpenMX Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/data_preparation.html#siesta-honpas-process">SIESTA/HONPAS Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/data_preparation.html#abacus-process">ABACUS Process</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/training.html">Model Training Process</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/training.html#training-mode-classification">Training Mode Classification</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/training.html#training-command">Training Command</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/training.html#key-configuration-items">Key Configuration Items</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/training.html#training-monitoring">Training Monitoring</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/prediction.html">Model Prediction Operation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/prediction.html#preparation-for-prediction">Preparation for Prediction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/prediction.html#execute-prediction">Execute Prediction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/prediction.html#output-results">Output Results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/band_calculation.html">Band Structure Calculation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/band_calculation.html#operation-process">Operation Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/band_calculation.html#band-calculation-for-large-systems">Band Calculation for Large Systems</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/uni_hamgnn.html">Uni-HamGNN Universal Model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/uni_hamgnn.html#model-introduction">Model Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/uni_hamgnn.html#input-requirements">Input Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/uni_hamgnn.html#usage-process">Usage Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/uni_hamgnn.html#output-results">Output Results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/parameters.html">HamGNN Parameter Details</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/parameters.html#setup-basic-settings">setup (Basic Settings)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/parameters.html#dataset-params-dataset-parameters">dataset_params (Dataset Parameters)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/parameters.html#losses-metrics-loss-functions-and-evaluation-metrics">losses_metrics (Loss Functions and Evaluation Metrics)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/parameters.html#optim-params-optimizer-parameters">optim_params (Optimizer Parameters)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/parameters.html#output-nets-hamgnn-out-output-network-parameters">output_nets.HamGNN_out (Output Network Parameters)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/parameters.html#representation-nets-hamgnn-pre-representation-network-parameters">representation_nets.HamGNN_pre (Representation Network Parameters)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/parameters.html#parameter-adjustment-recommendations">Parameter Adjustment Recommendations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/parameters.html#references">References</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Model Structure</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-HamGNN_v_2_1.models.base_model">Base Model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_1.models.base_model.get_radii_from_atomic_numbers"><code class="docutils literal notranslate"><span class="pre">get_radii_from_atomic_numbers()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_1.models.base_model.neighbor_list_and_relative_vec"><code class="docutils literal notranslate"><span class="pre">neighbor_list_and_relative_vec()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_1.models.base_model.find_matching_columns_of_A_in_B"><code class="docutils literal notranslate"><span class="pre">find_matching_columns_of_A_in_B()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_1.models.base_model.BaseModel"><code class="docutils literal notranslate"><span class="pre">BaseModel</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.models.base_model.BaseModel.forward"><code class="docutils literal notranslate"><span class="pre">BaseModel.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.models.base_model.BaseModel.generate_graph"><code class="docutils literal notranslate"><span class="pre">BaseModel.generate_graph()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.models.base_model.BaseModel.num_params"><code class="docutils literal notranslate"><span class="pre">BaseModel.num_params</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-HamGNN_v_2_1.models.hamgnn_conv">HamGNN Convolution</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_1.models.hamgnn_conv.HamGNNConvE3"><code class="docutils literal notranslate"><span class="pre">HamGNNConvE3</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.models.hamgnn_conv.HamGNNConvE3.forward"><code class="docutils literal notranslate"><span class="pre">HamGNNConvE3.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-HamGNN_v_2_1.models.hamgnn_transformer">HamGNN Transformer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_1.models.hamgnn_transformer.HamGNNTransformer"><code class="docutils literal notranslate"><span class="pre">HamGNNTransformer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.models.hamgnn_transformer.HamGNNTransformer.forward"><code class="docutils literal notranslate"><span class="pre">HamGNNTransformer.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-HamGNN_v_2_1.models.hamgnn_output">HamGNN Output Head</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_1.models.hamgnn_output.HamLayer"><code class="docutils literal notranslate"><span class="pre">HamLayer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.models.hamgnn_output.HamLayer.forward"><code class="docutils literal notranslate"><span class="pre">HamLayer.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.merge_tensor_components"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.merge_tensor_components()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.merge_rank2_tensor_components"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.merge_rank2_tensor_components()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.merge_rank0_tensor_components"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.merge_rank0_tensor_components()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.construct_j_coupling_matrix"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.construct_j_coupling_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.construct_k_coupling_matrix"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.construct_k_coupling_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.reorder_matrix"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.reorder_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.construct_molecular_hamiltonian"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.construct_molecular_hamiltonian()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.concatenate_hamiltonians_by_crystal"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.concatenate_hamiltonians_by_crystal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.symmetrize_hamiltonian"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.symmetrize_hamiltonian()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.symmetrize_onsite_hamiltonian"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.symmetrize_onsite_hamiltonian()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.symmetrize_offsite_hamiltonian"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.symmetrize_offsite_hamiltonian()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.symmetrize_onsite_hamiltonian_soc"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.symmetrize_onsite_hamiltonian_soc()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.symmetrize_offsite_hamiltonian_soc"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.symmetrize_offsite_hamiltonian_soc()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.calculate_band_energies_with_overlap"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.calculate_band_energies_with_overlap()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.calculate_band_energies"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.calculate_band_energies()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.calculate_band_energies_with_spin_orbit_coupling"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.calculate_band_energies_with_spin_orbit_coupling()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.apply_orbital_masks_to_hamiltonians"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.apply_orbital_masks_to_hamiltonians()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.symmetrize_orbital_coefficients"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.symmetrize_orbital_coefficients()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.create_cell_index_mapping"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.create_cell_index_mapping()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.extract_unique_cell_vectors"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.extract_unique_cell_vectors()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.build_edge_lookup_structures"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.build_edge_lookup_structures()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.create_orbital_validity_mask"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.create_orbital_validity_mask()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.build_interaction_masks"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.build_interaction_masks()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.build_column_wise_interaction_masks"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.build_column_wise_interaction_masks()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.build_spin_orbit_interaction_masks"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.build_spin_orbit_interaction_masks()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.calculate_sparsity_ratio"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.calculate_sparsity_ratio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.validate_elements_in_basis_def"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.validate_elements_in_basis_def()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.forward"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-HamGNN_v_2_1.models.Model">Main Model Implementation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_1.models.Model.Model"><code class="docutils literal notranslate"><span class="pre">Model</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.models.Model.Model.calculate_loss"><code class="docutils literal notranslate"><span class="pre">Model.calculate_loss()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.models.Model.Model.training_step"><code class="docutils literal notranslate"><span class="pre">Model.training_step()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.models.Model.Model.validation_step"><code class="docutils literal notranslate"><span class="pre">Model.validation_step()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.models.Model.Model.validation_epoch_end"><code class="docutils literal notranslate"><span class="pre">Model.validation_epoch_end()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.models.Model.Model.test_step"><code class="docutils literal notranslate"><span class="pre">Model.test_step()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.models.Model.Model.test_epoch_end"><code class="docutils literal notranslate"><span class="pre">Model.test_epoch_end()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.models.Model.Model.forward"><code class="docutils literal notranslate"><span class="pre">Model.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.models.Model.Model.log_metrics"><code class="docutils literal notranslate"><span class="pre">Model.log_metrics()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.models.Model.Model.configure_optimizers"><code class="docutils literal notranslate"><span class="pre">Model.configure_optimizers()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="gnn_core.html">GNN Core Layers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="gnn_core/message_passing.html">Message Passing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="gnn_core/message_passing.html#module-HamGNN_v_2_1.nn.message_passing">Message Pack Blocks</a><ul>
<li class="toctree-l4"><a class="reference internal" href="gnn_core/message_passing.html#HamGNN_v_2_1.nn.message_passing.MessagePackBlock"><code class="docutils literal notranslate"><span class="pre">MessagePackBlock</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="gnn_core/message_passing.html#HamGNN_v_2_1.nn.message_passing.MessagePackBlockV2"><code class="docutils literal notranslate"><span class="pre">MessagePackBlockV2</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="gnn_core/attention.html">Attention Mechanisms</a><ul>
<li class="toctree-l3"><a class="reference internal" href="gnn_core/attention.html#module-HamGNN_v_2_1.nn.attention">Attention Layers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="gnn_core/attention.html#HamGNN_v_2_1.nn.attention.AttentionAggregationV2"><code class="docutils literal notranslate"><span class="pre">AttentionAggregationV2</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="gnn_core/attention.html#HamGNN_v_2_1.nn.attention.AttentionAggregation"><code class="docutils literal notranslate"><span class="pre">AttentionAggregation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="gnn_core/attention.html#HamGNN_v_2_1.nn.attention.AttentionBlockE3"><code class="docutils literal notranslate"><span class="pre">AttentionBlockE3</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="gnn_core/attention.html#module-HamGNN_v_2_1.nn.attention_utils">Attention Utilities</a><ul>
<li class="toctree-l4"><a class="reference internal" href="gnn_core/attention.html#HamGNN_v_2_1.nn.attention_utils.VectorToAttentionHeads"><code class="docutils literal notranslate"><span class="pre">VectorToAttentionHeads</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="gnn_core/attention.html#HamGNN_v_2_1.nn.attention_utils.AttentionHeadsToVector"><code class="docutils literal notranslate"><span class="pre">AttentionHeadsToVector</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="gnn_core/convolution.html">Convolution Layers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="gnn_core/convolution.html#module-HamGNN_v_2_1.nn.convolution">Graph Convolution Operations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="gnn_core/convolution.html#HamGNN_v_2_1.nn.convolution.ConvBlockE3"><code class="docutils literal notranslate"><span class="pre">ConvBlockE3</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="gnn_core/tensor_operations.html">Tensor Operations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="gnn_core/tensor_operations.html#module-HamGNN_v_2_1.nn.tensor_products">Tensor Products</a><ul>
<li class="toctree-l4"><a class="reference internal" href="gnn_core/tensor_operations.html#HamGNN_v_2_1.nn.tensor_products.LinearScaleWithWeights"><code class="docutils literal notranslate"><span class="pre">LinearScaleWithWeights</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="gnn_core/tensor_operations.html#HamGNN_v_2_1.nn.tensor_products.TensorProductWithMemoryOptimizationWithWeight"><code class="docutils literal notranslate"><span class="pre">TensorProductWithMemoryOptimizationWithWeight</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="gnn_core/tensor_operations.html#HamGNN_v_2_1.nn.tensor_products.TensorProductWithScalarComponents"><code class="docutils literal notranslate"><span class="pre">TensorProductWithScalarComponents</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="gnn_core/tensor_operations.html#HamGNN_v_2_1.nn.tensor_products.ConcatenatedIrrepsTensorProduct"><code class="docutils literal notranslate"><span class="pre">ConcatenatedIrrepsTensorProduct</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="gnn_core/interaction_blocks.html">Interaction Blocks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="gnn_core/interaction_blocks.html#module-HamGNN_v_2_1.nn.interaction_blocks">Neural Network Interaction Components</a><ul>
<li class="toctree-l4"><a class="reference internal" href="gnn_core/interaction_blocks.html#HamGNN_v_2_1.nn.interaction_blocks.PairInteractionBlock"><code class="docutils literal notranslate"><span class="pre">PairInteractionBlock</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="gnn_core/interaction_blocks.html#HamGNN_v_2_1.nn.interaction_blocks.CorrProductBlock"><code class="docutils literal notranslate"><span class="pre">CorrProductBlock</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="gnn_core/interaction_blocks.html#HamGNN_v_2_1.nn.interaction_blocks.ResidualBlock"><code class="docutils literal notranslate"><span class="pre">ResidualBlock</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="gnn_core/physics_tools.html">Physics Tools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="gnn_core/physics_tools.html#module-HamGNN_v_2_1.physics.Clebsch_Gordan_coefficients">Clebsch-Gordan Coefficients</a><ul>
<li class="toctree-l4"><a class="reference internal" href="gnn_core/physics_tools.html#HamGNN_v_2_1.physics.Clebsch_Gordan_coefficients.ClebschGordanCoefficients"><code class="docutils literal notranslate"><span class="pre">ClebschGordanCoefficients</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="gnn_core/physics_tools.html#module-HamGNN_v_2_1.physics.kpoints">K-Points</a><ul>
<li class="toctree-l4"><a class="reference internal" href="gnn_core/physics_tools.html#HamGNN_v_2_1.physics.kpoints.kpoints_generator"><code class="docutils literal notranslate"><span class="pre">kpoints_generator</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="gnn_core/physics_tools.html#HamGNN_v_2_1.physics.kpoints.compute_reciprocal_lattice_vectors"><code class="docutils literal notranslate"><span class="pre">compute_reciprocal_lattice_vectors()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="gnn_core/physics_tools.html#HamGNN_v_2_1.physics.kpoints.generate_kpoint_grid"><code class="docutils literal notranslate"><span class="pre">generate_kpoint_grid()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="gnn_core/physics_tools.html#module-HamGNN_v_2_1.physics.matrix_operations">Matrix Operations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="gnn_core/physics_tools.html#HamGNN_v_2_1.physics.matrix_operations.HamLayer"><code class="docutils literal notranslate"><span class="pre">HamLayer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="gnn_core/physics_tools.html#HamGNN_v_2_1.physics.matrix_operations.TensorExpansion"><code class="docutils literal notranslate"><span class="pre">TensorExpansion</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="gnn_core/physics_tools.html#HamGNN_v_2_1.physics.matrix_operations.OverlapExpand"><code class="docutils literal notranslate"><span class="pre">OverlapExpand</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="gnn_core/physics_tools.html#HamGNN_v_2_1.physics.matrix_operations.TensorMerge"><code class="docutils literal notranslate"><span class="pre">TensorMerge</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="model_components.html">Model Components</a><ul>
<li class="toctree-l2"><a class="reference internal" href="model_components.html#module-HamGNN_v_2_1.nn.embeddings">Embeddings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.nn.embeddings.RadialBasisEdgeEncoding"><code class="docutils literal notranslate"><span class="pre">RadialBasisEdgeEncoding</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.nn.embeddings.RadialBasisEdgeEncoding.out_field"><code class="docutils literal notranslate"><span class="pre">RadialBasisEdgeEncoding.out_field</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.nn.embeddings.RadialBasisEdgeEncoding.forward"><code class="docutils literal notranslate"><span class="pre">RadialBasisEdgeEncoding.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.nn.embeddings.EdgeScalarEmbedding"><code class="docutils literal notranslate"><span class="pre">EdgeScalarEmbedding</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.nn.embeddings.EdgeScalarEmbedding.forward"><code class="docutils literal notranslate"><span class="pre">EdgeScalarEmbedding.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.nn.embeddings.LocalEnvironmentEmbedding"><code class="docutils literal notranslate"><span class="pre">LocalEnvironmentEmbedding</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.nn.embeddings.LocalEnvironmentEmbedding.forward"><code class="docutils literal notranslate"><span class="pre">LocalEnvironmentEmbedding.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.nn.embeddings.PairInteractionEmbeddingBlock"><code class="docutils literal notranslate"><span class="pre">PairInteractionEmbeddingBlock</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.nn.embeddings.PairInteractionEmbeddingBlock.create_linear"><code class="docutils literal notranslate"><span class="pre">PairInteractionEmbeddingBlock.create_linear()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.nn.embeddings.PairInteractionEmbeddingBlock.create_tensor_product"><code class="docutils literal notranslate"><span class="pre">PairInteractionEmbeddingBlock.create_tensor_product()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.nn.embeddings.PairInteractionEmbeddingBlock.init_weight_generator"><code class="docutils literal notranslate"><span class="pre">PairInteractionEmbeddingBlock.init_weight_generator()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.nn.embeddings.PairInteractionEmbeddingBlock.forward"><code class="docutils literal notranslate"><span class="pre">PairInteractionEmbeddingBlock.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.nn.embeddings.Embedding"><code class="docutils literal notranslate"><span class="pre">Embedding</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.nn.embeddings.Embedding.reset_parameters"><code class="docutils literal notranslate"><span class="pre">Embedding.reset_parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.nn.embeddings.Embedding.forward"><code class="docutils literal notranslate"><span class="pre">Embedding.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model_components.html#module-HamGNN_v_2_1.nn.electron_configurations">Electron Configurations</a></li>
<li class="toctree-l2"><a class="reference internal" href="model_components.html#module-HamGNN_v_2_1.utils.mlp">MLP Utilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.mlp.linear_bn_act"><code class="docutils literal notranslate"><span class="pre">linear_bn_act()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.mlp.denseLayer"><code class="docutils literal notranslate"><span class="pre">denseLayer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.mlp.denseLayer.forward"><code class="docutils literal notranslate"><span class="pre">denseLayer.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.mlp.Dense"><code class="docutils literal notranslate"><span class="pre">Dense</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.mlp.Dense.reset_parameters"><code class="docutils literal notranslate"><span class="pre">Dense.reset_parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.mlp.Dense.forward"><code class="docutils literal notranslate"><span class="pre">Dense.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model_components.html#module-HamGNN_v_2_1.utils.activation">Activation Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.activation.shifted_softplus"><code class="docutils literal notranslate"><span class="pre">shifted_softplus()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.activation.switch_function"><code class="docutils literal notranslate"><span class="pre">switch_function()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.activation.softplus_inverse"><code class="docutils literal notranslate"><span class="pre">softplus_inverse()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.activation.SoftUnitStepCutoff"><code class="docutils literal notranslate"><span class="pre">SoftUnitStepCutoff</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.activation.SoftUnitStepCutoff.cutoff"><code class="docutils literal notranslate"><span class="pre">SoftUnitStepCutoff.cutoff</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.activation.SoftUnitStepCutoff.cut_param"><code class="docutils literal notranslate"><span class="pre">SoftUnitStepCutoff.cut_param</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.activation.SoftUnitStepCutoff.forward"><code class="docutils literal notranslate"><span class="pre">SoftUnitStepCutoff.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.activation.swish"><code class="docutils literal notranslate"><span class="pre">swish()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.activation.SSP"><code class="docutils literal notranslate"><span class="pre">SSP</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.activation.SSP.forward"><code class="docutils literal notranslate"><span class="pre">SSP.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.activation.SSP.extra_repr"><code class="docutils literal notranslate"><span class="pre">SSP.extra_repr()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.activation.SWISH"><code class="docutils literal notranslate"><span class="pre">SWISH</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.activation.SWISH.forward"><code class="docutils literal notranslate"><span class="pre">SWISH.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.activation.get_activation"><code class="docutils literal notranslate"><span class="pre">get_activation()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model_components.html#module-HamGNN_v_2_1.utils.basis_functions">Basis Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.basis_functions.BernsteinRadialBasisFunctions"><code class="docutils literal notranslate"><span class="pre">BernsteinRadialBasisFunctions</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.basis_functions.BernsteinRadialBasisFunctions.reset_parameters"><code class="docutils literal notranslate"><span class="pre">BernsteinRadialBasisFunctions.reset_parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.basis_functions.BernsteinRadialBasisFunctions.forward"><code class="docutils literal notranslate"><span class="pre">BernsteinRadialBasisFunctions.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.basis_functions.ExponentialBernsteinRadialBasisFunctions"><code class="docutils literal notranslate"><span class="pre">ExponentialBernsteinRadialBasisFunctions</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.basis_functions.ExponentialBernsteinRadialBasisFunctions.reset_parameters"><code class="docutils literal notranslate"><span class="pre">ExponentialBernsteinRadialBasisFunctions.reset_parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.basis_functions.ExponentialBernsteinRadialBasisFunctions.forward"><code class="docutils literal notranslate"><span class="pre">ExponentialBernsteinRadialBasisFunctions.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.basis_functions.ExponentialGaussianRadialBasisFunctions"><code class="docutils literal notranslate"><span class="pre">ExponentialGaussianRadialBasisFunctions</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.basis_functions.ExponentialGaussianRadialBasisFunctions.reset_parameters"><code class="docutils literal notranslate"><span class="pre">ExponentialGaussianRadialBasisFunctions.reset_parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.basis_functions.ExponentialGaussianRadialBasisFunctions.forward"><code class="docutils literal notranslate"><span class="pre">ExponentialGaussianRadialBasisFunctions.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.basis_functions.GaussianRadialBasisFunctions"><code class="docutils literal notranslate"><span class="pre">GaussianRadialBasisFunctions</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.basis_functions.GaussianRadialBasisFunctions.reset_parameters"><code class="docutils literal notranslate"><span class="pre">GaussianRadialBasisFunctions.reset_parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.basis_functions.GaussianRadialBasisFunctions.forward"><code class="docutils literal notranslate"><span class="pre">GaussianRadialBasisFunctions.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.basis_functions.OverlapBernsteinRadialBasisFunctions"><code class="docutils literal notranslate"><span class="pre">OverlapBernsteinRadialBasisFunctions</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.basis_functions.OverlapBernsteinRadialBasisFunctions.reset_parameters"><code class="docutils literal notranslate"><span class="pre">OverlapBernsteinRadialBasisFunctions.reset_parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.basis_functions.OverlapBernsteinRadialBasisFunctions.forward"><code class="docutils literal notranslate"><span class="pre">OverlapBernsteinRadialBasisFunctions.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.basis_functions.sph_harm_layer"><code class="docutils literal notranslate"><span class="pre">sph_harm_layer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.basis_functions.sph_harm_layer.forward"><code class="docutils literal notranslate"><span class="pre">sph_harm_layer.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.basis_functions.BesselBasis"><code class="docutils literal notranslate"><span class="pre">BesselBasis</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.basis_functions.BesselBasis.forward"><code class="docutils literal notranslate"><span class="pre">BesselBasis.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.basis_functions.GaussianSmearing"><code class="docutils literal notranslate"><span class="pre">GaussianSmearing</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.basis_functions.GaussianSmearing.forward"><code class="docutils literal notranslate"><span class="pre">GaussianSmearing.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model_components.html#module-HamGNN_v_2_1.utils.cutoff_functions">Cutoff Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.cutoff_functions.cutoff_function"><code class="docutils literal notranslate"><span class="pre">cutoff_function()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.cutoff_functions.cuttoff_envelope"><code class="docutils literal notranslate"><span class="pre">cuttoff_envelope</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.cutoff_functions.cuttoff_envelope.forward"><code class="docutils literal notranslate"><span class="pre">cuttoff_envelope.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.cutoff_functions.CosineCutoff"><code class="docutils literal notranslate"><span class="pre">CosineCutoff</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.cutoff_functions.CosineCutoff.forward"><code class="docutils literal notranslate"><span class="pre">CosineCutoff.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.cutoff_functions.SoftUnitStepCutoff"><code class="docutils literal notranslate"><span class="pre">SoftUnitStepCutoff</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.cutoff_functions.SoftUnitStepCutoff.cutoff"><code class="docutils literal notranslate"><span class="pre">SoftUnitStepCutoff.cutoff</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.cutoff_functions.SoftUnitStepCutoff.cut_param"><code class="docutils literal notranslate"><span class="pre">SoftUnitStepCutoff.cut_param</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.cutoff_functions.SoftUnitStepCutoff.forward"><code class="docutils literal notranslate"><span class="pre">SoftUnitStepCutoff.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model_components.html#module-HamGNN_v_2_1.utils.regression_layers">Regression Layers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.regression_layers.denseRegression"><code class="docutils literal notranslate"><span class="pre">denseRegression</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.regression_layers.denseRegression.forward"><code class="docutils literal notranslate"><span class="pre">denseRegression.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.regression_layers.MLPRegression"><code class="docutils literal notranslate"><span class="pre">MLPRegression</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.regression_layers.MLPRegression.forward"><code class="docutils literal notranslate"><span class="pre">MLPRegression.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model_components.html#module-HamGNN_v_2_1.utils.hparam">Hyperparameter Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model_components.html#HamGNN_v_2_1.utils.hparam.get_hparam_dict"><code class="docutils literal notranslate"><span class="pre">get_hparam_dict()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="data_processing.html">Data Processing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="data_processing.html#graph-data">Graph Data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#module-HamGNN_v_2_1.config.config_parsing">Config Parsing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#HamGNN_v_2_1.config.config_parsing.config_default"><code class="docutils literal notranslate"><span class="pre">config_default</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#HamGNN_v_2_1.config.config_parsing.recursive_update"><code class="docutils literal notranslate"><span class="pre">recursive_update()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#HamGNN_v_2_1.config.config_parsing.load_config"><code class="docutils literal notranslate"><span class="pre">load_config()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="utilities.html">Utilities</a><ul>
<li class="toctree-l2"><a class="reference internal" href="utilities.html#module-HamGNN_v_2_1.utils.irreps_utils">Irreps Utilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="utilities.html#HamGNN_v_2_1.utils.irreps_utils.extract_scalar_irreps"><code class="docutils literal notranslate"><span class="pre">extract_scalar_irreps()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="utilities.html#HamGNN_v_2_1.utils.irreps_utils.irreps2gate"><code class="docutils literal notranslate"><span class="pre">irreps2gate()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="utilities.html#HamGNN_v_2_1.utils.irreps_utils.scale_irreps"><code class="docutils literal notranslate"><span class="pre">scale_irreps()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="utilities.html#HamGNN_v_2_1.utils.irreps_utils.filter_and_split_irreps"><code class="docutils literal notranslate"><span class="pre">filter_and_split_irreps()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="utilities.html#module-HamGNN_v_2_1.utils.triplets">Triplets</a><ul>
<li class="toctree-l3"><a class="reference internal" href="utilities.html#HamGNN_v_2_1.utils.triplets.triplets"><code class="docutils literal notranslate"><span class="pre">triplets()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="utilities.html#module-HamGNN_v_2_1.utils.math_utils">Math Utilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="utilities.html#HamGNN_v_2_1.utils.math_utils.count_neighbors_per_node"><code class="docutils literal notranslate"><span class="pre">count_neighbors_per_node()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="utilities.html#HamGNN_v_2_1.utils.math_utils.prod"><code class="docutils literal notranslate"><span class="pre">prod()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="utilities.html#HamGNN_v_2_1.utils.math_utils.blockwise_2x2_concat"><code class="docutils literal notranslate"><span class="pre">blockwise_2x2_concat()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="utilities.html#HamGNN_v_2_1.utils.math_utils.extract_elements_above_threshold"><code class="docutils literal notranslate"><span class="pre">extract_elements_above_threshold()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="utilities.html#HamGNN_v_2_1.utils.math_utils.upgrade_tensor_precision"><code class="docutils literal notranslate"><span class="pre">upgrade_tensor_precision()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="utilities.html#module-HamGNN_v_2_1.utils.losses">Loss Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="utilities.html#HamGNN_v_2_1.utils.losses.cosine_similarity_loss"><code class="docutils literal notranslate"><span class="pre">cosine_similarity_loss</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="utilities.html#HamGNN_v_2_1.utils.losses.cosine_similarity_loss.forward"><code class="docutils literal notranslate"><span class="pre">cosine_similarity_loss.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="utilities.html#HamGNN_v_2_1.utils.losses.sum_zero_loss"><code class="docutils literal notranslate"><span class="pre">sum_zero_loss</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="utilities.html#HamGNN_v_2_1.utils.losses.sum_zero_loss.forward"><code class="docutils literal notranslate"><span class="pre">sum_zero_loss.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="utilities.html#HamGNN_v_2_1.utils.losses.Euclidean_loss"><code class="docutils literal notranslate"><span class="pre">Euclidean_loss</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="utilities.html#HamGNN_v_2_1.utils.losses.Euclidean_loss.forward"><code class="docutils literal notranslate"><span class="pre">Euclidean_loss.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="utilities.html#HamGNN_v_2_1.utils.losses.RMSELoss"><code class="docutils literal notranslate"><span class="pre">RMSELoss</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="utilities.html#HamGNN_v_2_1.utils.losses.RMSELoss.forward"><code class="docutils literal notranslate"><span class="pre">RMSELoss.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="utilities.html#HamGNN_v_2_1.utils.losses.parse_metric_func"><code class="docutils literal notranslate"><span class="pre">parse_metric_func()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="utilities.html#module-HamGNN_v_2_1.utils.visualization">Visualization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="utilities.html#HamGNN_v_2_1.utils.visualization.scatter_plot"><code class="docutils literal notranslate"><span class="pre">scatter_plot()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #2980B9" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">HamGNN_v_2_1</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Model Structure</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/bud-primordium/HamGNN_2_1_temp/blob/main/docs/api/model_structure.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="../user_guide/parameters.html" class="btn btn-neutral float-left" title="HamGNN Parameter Details" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="gnn_core.html" class="btn btn-neutral float-right" title="GNN Core Layers" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="model-structure">
<h1>Model Structure<a class="headerlink" href="#model-structure" title="Link to this heading"></a></h1>
<section id="module-HamGNN_v_2_1.models.base_model">
<span id="base-model"></span><h2>Base Model<a class="headerlink" href="#module-HamGNN_v_2_1.models.base_model" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.base_model.get_radii_from_atomic_numbers">
<span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_1.models.base_model.</span></span><span class="sig-name descname"><span class="pre">get_radii_from_atomic_numbers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atomic_numbers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'openmx'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/base_model.html#get_radii_from_atomic_numbers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.base_model.get_radii_from_atomic_numbers" title="Link to this definition"></a></dt>
<dd><p>Retrieves the scaled atomic radii for a given list or tensor of atomic numbers.</p>
<p>Parameters:
- atomic_numbers (Union[torch.Tensor, List[int]]): A list or tensor containing atomic numbers.
- radius_scale (float): A scaling factor to multiply the atomic radii. Default is 1.5.
- radius_type (str): The software, in which the atomic radius is utilized, originates from a specific source. Default is openmx.</p>
<p>Returns:
- List[float]: A list of scaled atomic radii corresponding to the input atomic numbers.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.base_model.neighbor_list_and_relative_vec">
<span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_1.models.base_model.</span></span><span class="sig-name descname"><span class="pre">neighbor_list_and_relative_vec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">self_interaction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict_self_interaction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pbc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/base_model.html#neighbor_list_and_relative_vec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.base_model.neighbor_list_and_relative_vec" title="Link to this definition"></a></dt>
<dd><p>Create neighbor list and neighbor vectors based on radial cutoff.</p>
<p>Edges are given by the following convention:
- <code class="docutils literal notranslate"><span class="pre">edge_index[0]</span></code> is the <em>source</em> (convolution center).
- <code class="docutils literal notranslate"><span class="pre">edge_index[1]</span></code> is the <em>target</em> (neighbor).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos</strong> (<em>shape</em><em> [</em><em>N</em><em>, </em><em>3</em><em>]</em>) – Positional coordinates; Tensor or numpy array.</p></li>
<li><p><strong>r_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Radial cutoff distance for neighbor finding.</p></li>
<li><p><strong>cell</strong> (<em>numpy shape</em><em> [</em><em>3</em><em>, </em><em>3</em><em>]</em>) – Cell for periodic boundary conditions.</p></li>
<li><p><strong>pbc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em> or </em><em>3-tuple</em><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Periodicity in each of the three dimensions.</p></li>
<li><p><strong>self_interaction</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Include same periodic image self-edges.</p></li>
<li><p><strong>strict_self_interaction</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Include any self interaction edges.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of edges.
shifts (torch.Tensor [num_edges, 3]): Relative cell shift vectors.
cell_tensor (torch.Tensor [3, 3]): Cell tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>edge_index (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)">torch.Tensor</a> [2, num_edges])</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.base_model.find_matching_columns_of_A_in_B">
<span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_1.models.base_model.</span></span><span class="sig-name descname"><span class="pre">find_matching_columns_of_A_in_B</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/base_model.html#find_matching_columns_of_A_in_B"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.base_model.find_matching_columns_of_A_in_B" title="Link to this definition"></a></dt>
<dd><p>Finds matching columns between two matrices A and B.
Parameters:
- A (torch.Tensor): First matrix.
- B (torch.Tensor): Second matrix.
Returns:
- torch.Tensor: Indices of matching columns in B.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.base_model.BaseModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_1.models.base_model.</span></span><span class="sig-name descname"><span class="pre">BaseModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">radius_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'openmx'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/base_model.html#BaseModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.base_model.BaseModel" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.base_model.BaseModel.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/base_model.html#BaseModel.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.base_model.BaseModel.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.base_model.BaseModel.generate_graph">
<span class="sig-name descname"><span class="pre">generate_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/base_model.html#BaseModel.generate_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.base_model.BaseModel.generate_graph" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.base_model.BaseModel.num_params">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_params</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#HamGNN_v_2_1.models.base_model.BaseModel.num_params" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-HamGNN_v_2_1.models.hamgnn_conv">
<span id="hamgnn-convolution"></span><h2>HamGNN Convolution<a class="headerlink" href="#module-HamGNN_v_2_1.models.hamgnn_conv" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.hamgnn_conv.HamGNNConvE3">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_1.models.hamgnn_conv.</span></span><span class="sig-name descname"><span class="pre">HamGNNConvE3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/hamgnn_conv.html#HamGNNConvE3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.hamgnn_conv.HamGNNConvE3" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#HamGNN_v_2_1.models.base_model.BaseModel" title="HamGNN_v_2_1.models.base_model.BaseModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.hamgnn_conv.HamGNNConvE3.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/hamgnn_conv.html#HamGNNConvE3.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.hamgnn_conv.HamGNNConvE3.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="module-HamGNN_v_2_1.models.hamgnn_transformer">
<span id="hamgnn-transformer"></span><h2>HamGNN Transformer<a class="headerlink" href="#module-HamGNN_v_2_1.models.hamgnn_transformer" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.hamgnn_transformer.HamGNNTransformer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_1.models.hamgnn_transformer.</span></span><span class="sig-name descname"><span class="pre">HamGNNTransformer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/hamgnn_transformer.html#HamGNNTransformer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.hamgnn_transformer.HamGNNTransformer" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#HamGNN_v_2_1.models.base_model.BaseModel" title="HamGNN_v_2_1.models.base_model.BaseModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.hamgnn_transformer.HamGNNTransformer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/hamgnn_transformer.html#HamGNNTransformer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.hamgnn_transformer.HamGNNTransformer.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="module-HamGNN_v_2_1.models.hamgnn_output">
<span id="hamgnn-output-head"></span><h2>HamGNN Output Head<a class="headerlink" href="#module-HamGNN_v_2_1.models.hamgnn_output" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.hamgnn_output.HamLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_1.models.hamgnn_output.</span></span><span class="sig-name descname"><span class="pre">HamLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">irreps_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_irreps_hidden</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonlinearity_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gate'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resnet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/hamgnn_output.html#HamLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.hamgnn_output.HamLayer" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.hamgnn_output.HamLayer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/hamgnn_output.html#HamLayer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.hamgnn_output.HamLayer.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_1.models.hamgnn_output.</span></span><span class="sig-name descname"><span class="pre">HamGNNPlusPlusOut</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">irreps_in_node</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_in_edge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nao_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">14</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_forces</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">create_graph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ham_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'openmx'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ham_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetrize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_triplet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calculate_band_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band_num_control</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">soc_switch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonlinearity_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gate'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">export_reciprocal_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_H0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">soc_basis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'so3'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin_constrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_learned_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minMagneticMoment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collinear_spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_point_shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_H_nonsoc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_nonzero_mask_tensor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calculate_sparsity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/hamgnn_output.html#HamGNNPlusPlusOut"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></p>
<p>Neural network module for computing Hamiltonian matrices using Graph Neural Networks.</p>
<p>This class implements a GNN architecture for quantum chemistry applications, supporting
different Hamiltonian types (openmx, siesta, abacus) with various configuration options
for physics-informed neural network training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>irreps_in_node</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>o3.Irreps</em><em>]</em>) – Input irreps for node features.</p></li>
<li><p><strong>irreps_in_edge</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>o3.Irreps</em><em>]</em>) – Input irreps for edge features.</p></li>
<li><p><strong>nao_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Maximum number of atomic orbitals.</p></li>
<li><p><strong>return_forces</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether to compute forces during forward pass.</p></li>
<li><p><strong>create_graph</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether to create computational graph for backpropagation.</p></li>
<li><p><strong>ham_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Type of Hamiltonian (‘openmx’, ‘siesta’, ‘abacus’, or ‘pasp’).</p></li>
<li><p><strong>ham_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether to only compute the Hamiltonian matrix.</p></li>
<li><p><strong>symmetrize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether to symmetrize the Hamiltonian matrix.</p></li>
<li><p><strong>include_triplet</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether to include triplet interactions.</p></li>
<li><p><strong>calculate_band_energy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether to calculate band energies.</p></li>
<li><p><strong>num_k</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of k-points for band structure calculations.</p></li>
<li><p><strong>k_path</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>, </em><em>np.ndarray</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>]</em>) – Path in k-space for band structure.</p></li>
<li><p><strong>band_num_control</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Control for band numbers.</p></li>
<li><p><strong>soc_switch</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether to include spin-orbit coupling.</p></li>
<li><p><strong>nonlinearity_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Type of nonlinearity for neural network layers.</p></li>
<li><p><strong>export_reciprocal_values</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether to export reciprocal space values.</p></li>
<li><p><strong>add_H0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether to add the initial Hamiltonian term H0.</p></li>
<li><p><strong>soc_basis</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Basis for spin-orbit coupling (‘so3’ or ‘su2’).</p></li>
<li><p><strong>spin_constrained</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether to apply spin constraints.</p></li>
<li><p><strong>use_learned_weight</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether to use learned weights.</p></li>
<li><p><strong>minMagneticMoment</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Minimum magnetic moment threshold.</p></li>
<li><p><strong>collinear_spin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether to consider collinear spin.</p></li>
<li><p><strong>zero_point_shift</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether to apply zero-point energy shift.</p></li>
<li><p><strong>add_H_nonsoc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether to add non-SOC Hamiltonian.</p></li>
<li><p><strong>get_nonzero_mask_tensor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether to get nonzero mask tensor.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.merge_tensor_components">
<span class="sig-name descname"><span class="pre">merge_tensor_components</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spherical_components</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/hamgnn_output.html#HamGNNPlusPlusOut.merge_tensor_components"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.merge_tensor_components" title="Link to this definition"></a></dt>
<dd><p>Merge spherical tensor components into a matrix using Clebsch-Gordan coefficients.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>spherical_components</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – List of tensors representing spherical
components of irreducible representations. Each tensor has shape
(batch_size, component_dim).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Merged matrix with shape (batch_size, nao_max * nao_max) representing</dt><dd><p>flattened matrix of merged components.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.merge_rank2_tensor_components">
<span class="sig-name descname"><span class="pre">merge_rank2_tensor_components</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spherical_components</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/hamgnn_output.html#HamGNNPlusPlusOut.merge_rank2_tensor_components"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.merge_rank2_tensor_components" title="Link to this definition"></a></dt>
<dd><p>Merge rank-2 tensor components into a block matrix representation.</p>
<p>This function is specialized for rank-2 tensors and applies permutation to the result.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>spherical_components</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – List of tensors representing spherical
components of irreducible representations.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Merged block matrix with shape (batch_size, n_blocks, 3, 3) after</dt><dd><p>applying a specific permutation.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.merge_rank0_tensor_components">
<span class="sig-name descname"><span class="pre">merge_rank0_tensor_components</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spherical_components</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/hamgnn_output.html#HamGNNPlusPlusOut.merge_rank0_tensor_components"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.merge_rank0_tensor_components" title="Link to this definition"></a></dt>
<dd><p>Merge rank-0 (scalar) tensor components into a matrix representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>spherical_components</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – List of tensors representing spherical
components of irreducible representations.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Merged matrix with shape (batch_size, nao_max, nao_max).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.construct_j_coupling_matrix">
<span class="sig-name descname"><span class="pre">construct_j_coupling_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coupling_coefficients</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/hamgnn_output.html#HamGNNPlusPlusOut.construct_j_coupling_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.construct_j_coupling_matrix" title="Link to this definition"></a></dt>
<dd><p>Construct a matrix representation of J-coupling (spin-orbit interaction).</p>
<p>Builds a matrix representation for J-coupling which can be either rank-2
(with spin-orbit coupling) or rank-0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>coupling_coefficients</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – Tensor containing coupling coefficients.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>The J-coupling matrix. If spin-orbit coupling is enabled,</dt><dd><p>shape is (batch_size, nao_max, nao_max, 3, 3); otherwise, shape is
(batch_size, nao_max, nao_max).</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.construct_k_coupling_matrix">
<span class="sig-name descname"><span class="pre">construct_k_coupling_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coupling_coefficients</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/hamgnn_output.html#HamGNNPlusPlusOut.construct_k_coupling_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.construct_k_coupling_matrix" title="Link to this definition"></a></dt>
<dd><p>Construct a matrix representation of exchange coupling (K-term).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>coupling_coefficients</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – Tensor containing exchange coupling coefficients
with shape (n_atoms_or_edges, coefficients_per_block * n_blocks).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Exchange coupling matrix with shape (n_atoms_or_edges, nao_max, nao_max).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.reorder_matrix">
<span class="sig-name descname"><span class="pre">reorder_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matrix</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/hamgnn_output.html#HamGNNPlusPlusOut.reorder_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.reorder_matrix" title="Link to this definition"></a></dt>
<dd><p>Reorder matrix elements to match the atomic orbital convention used by DFT.</p>
<p>This function performs two types of transformations:
1. Reorders rows and columns according to a predefined permutation (if defined)
2. Flips the sign of specific elements (if defined)</p>
<p>These transformations ensure compatibility with DFT’s atomic orbital ordering
convention, which may differ from the internal representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>matrix</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – Input matrix in flattened form,
with shape (batch_size, nao_max2) where nao_max is the maximum
number of atomic orbitals.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Reordered matrix in the same shape as input,</dt><dd><p>but with elements rearranged to match DFT conventions.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.construct_molecular_hamiltonian">
<span class="sig-name descname"><span class="pre">construct_molecular_hamiltonian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onsite_hamiltonian</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offsite_hamiltonian</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/hamgnn_output.html#HamGNNPlusPlusOut.construct_molecular_hamiltonian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.construct_molecular_hamiltonian" title="Link to this definition"></a></dt>
<dd><p>Construct a complete molecular Hamiltonian matrix from on-site and off-site components.</p>
<p>This function transforms separate on-site (diagonal) and off-site (interaction) Hamiltonian
components into a unified molecular Hamiltonian matrix. It handles atom-specific orbital
basis sets and masks invalid or padded orbitals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>DataObject</em>) – Object containing crystal structure information, including:
- z: Atomic numbers
- node_counts: Number of atoms in each crystal
- edge_index: Edges between atoms (indices of connected atom pairs)</p></li>
<li><p><strong>onsite_hamiltonian</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – On-site Hamiltonian matrix elements for each atom,
with shape (n_atoms, nao_max^2)</p></li>
<li><p><strong>offsite_hamiltonian</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – Off-site Hamiltonian matrix elements for each edge,
with shape (n_edges, nao_max^2)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Complete molecular Hamiltonian matrix with shape (n_molecules, n_orbitals, n_orbitals),</dt><dd><p>where n_orbitals is the number of valid atomic orbitals per molecule after removing
padding.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.concatenate_hamiltonians_by_crystal">
<span class="sig-name descname"><span class="pre">concatenate_hamiltonians_by_crystal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onsite_hamiltonians</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offsite_hamiltonians</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/hamgnn_output.html#HamGNNPlusPlusOut.concatenate_hamiltonians_by_crystal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.concatenate_hamiltonians_by_crystal" title="Link to this definition"></a></dt>
<dd><p>Concatenate on-site and off-site Hamiltonian matrices for each crystal in a batch.</p>
<p>This function organizes Hamiltonian matrices by crystal, interleaving on-site and
off-site components in a specific order required for further processing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>DataObject</em>) – Object containing crystal structure information, including:
- node_counts: Number of atoms in each crystal
- edge_index: Indices of connected atom pairs
- batch: Batch assignment for each node</p></li>
<li><p><strong>onsite_hamiltonians</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – On-site Hamiltonian matrices for all atoms,
with shape (total_atoms, matrix_dimension)</p></li>
<li><p><strong>offsite_hamiltonians</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – Off-site Hamiltonian matrices for all edges,
with shape (total_edges, matrix_dimension)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Concatenated Hamiltonian matrices organized by crystal,</dt><dd><p>with alternating on-site and off-site blocks.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.symmetrize_hamiltonian">
<span class="sig-name descname"><span class="pre">symmetrize_hamiltonian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hamiltonian</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_soc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inverse_edges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetry_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hermitian'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/hamgnn_output.html#HamGNNPlusPlusOut.symmetrize_hamiltonian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.symmetrize_hamiltonian" title="Link to this definition"></a></dt>
<dd><p>Apply symmetrization to a Hamiltonian matrix.</p>
<p>This is a general-purpose function that handles various types of symmetrization for both
on-site and off-site Hamiltonians, with or without spin-orbit coupling (SOC).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hamiltonian</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – Hamiltonian matrix elements in flattened form.</p></li>
<li><p><strong>is_soc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether this is a spin-orbit coupling Hamiltonian with
double dimension. Defaults to False.</p></li>
<li><p><strong>inverse_edges</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a><em>, </em><em>optional</em>) – Indices mapping each edge to its inverse
for off-site Hamiltonians. Required for off-site symmetrization. Defaults to None.</p></li>
<li><p><strong>symmetry_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Type of symmetry to apply:
- ‘hermitian’: Apply Hermitian symmetry H = 0.5*(H + H?)
- ‘anti-hermitian’: Apply anti-Hermitian symmetry H = 0.5*(H - H?)
Defaults to ‘hermitian’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Symmetrized Hamiltonian matrix in the same format as input.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.symmetrize_onsite_hamiltonian">
<span class="sig-name descname"><span class="pre">symmetrize_onsite_hamiltonian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hamiltonian</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermitian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/hamgnn_output.html#HamGNNPlusPlusOut.symmetrize_onsite_hamiltonian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.symmetrize_onsite_hamiltonian" title="Link to this definition"></a></dt>
<dd><p>Symmetrize on-site Hamiltonian matrices.</p>
<p>Applies Hermitian or anti-Hermitian symmetrization to on-site Hamiltonians.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hamiltonian</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – On-site Hamiltonian matrix elements.</p></li>
<li><p><strong>hermitian</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, apply Hermitian symmetry (H + H?),
otherwise apply anti-Hermitian symmetry (H - H?). Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Symmetrized Hamiltonian.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.symmetrize_offsite_hamiltonian">
<span class="sig-name descname"><span class="pre">symmetrize_offsite_hamiltonian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hamiltonian</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inverse_edges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermitian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/hamgnn_output.html#HamGNNPlusPlusOut.symmetrize_offsite_hamiltonian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.symmetrize_offsite_hamiltonian" title="Link to this definition"></a></dt>
<dd><p>Symmetrize off-site Hamiltonian matrices.</p>
<p>Applies Hermitian or anti-Hermitian symmetrization to off-site Hamiltonians,
using the inverse edge mapping to relate connected atom pairs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hamiltonian</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – Off-site Hamiltonian matrix elements.</p></li>
<li><p><strong>inverse_edges</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – Tensor mapping each edge to its inverse edge index.</p></li>
<li><p><strong>hermitian</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, apply Hermitian symmetry (H + H?),
otherwise apply anti-Hermitian symmetry (H - H?). Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Symmetrized Hamiltonian.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.symmetrize_onsite_hamiltonian_soc">
<span class="sig-name descname"><span class="pre">symmetrize_onsite_hamiltonian_soc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hamiltonian</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermitian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/hamgnn_output.html#HamGNNPlusPlusOut.symmetrize_onsite_hamiltonian_soc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.symmetrize_onsite_hamiltonian_soc" title="Link to this definition"></a></dt>
<dd><p>Symmetrize on-site Hamiltonian matrices with spin-orbit coupling.</p>
<p>Applies Hermitian or anti-Hermitian symmetrization to on-site Hamiltonians
that include spin-orbit coupling, which have double the dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hamiltonian</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – On-site SOC Hamiltonian matrix elements.</p></li>
<li><p><strong>hermitian</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, apply Hermitian symmetry (H + H?),
otherwise apply anti-Hermitian symmetry (H - H?). Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Symmetrized SOC Hamiltonian.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.symmetrize_offsite_hamiltonian_soc">
<span class="sig-name descname"><span class="pre">symmetrize_offsite_hamiltonian_soc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hamiltonian</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inverse_edges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermitian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/hamgnn_output.html#HamGNNPlusPlusOut.symmetrize_offsite_hamiltonian_soc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.symmetrize_offsite_hamiltonian_soc" title="Link to this definition"></a></dt>
<dd><p>Symmetrize off-site Hamiltonian matrices with spin-orbit coupling.</p>
<p>Applies Hermitian or anti-Hermitian symmetrization to off-site Hamiltonians
that include spin-orbit coupling, which have double the dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hamiltonian</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – Off-site SOC Hamiltonian matrix elements.</p></li>
<li><p><strong>inverse_edges</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – Tensor mapping each edge to its inverse edge index.</p></li>
<li><p><strong>hermitian</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, apply Hermitian symmetry (H + H?),
otherwise apply anti-Hermitian symmetry (H - H?). Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Symmetrized SOC Hamiltonian.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.calculate_band_energies_with_overlap">
<span class="sig-name descname"><span class="pre">calculate_band_energies_with_overlap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">onsite_hamiltonian</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offsite_hamiltonian</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onsite_overlap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offsite_overlap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crystal_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">export_reciprocal_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/hamgnn_output.html#HamGNNPlusPlusOut.calculate_band_energies_with_overlap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.calculate_band_energies_with_overlap" title="Link to this definition"></a></dt>
<dd><p>Calculate electronic band structure using provided Hamiltonian and overlap matrices.</p>
<p>This function computes electronic band energies, wavefunctions, and band gaps for a set
of crystal structures using the generalized eigenvalue problem H���� = E��S����. This version
allows debugging by accepting both reference and predicted overlap matrices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>onsite_hamiltonian</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – On-site Hamiltonian matrix elements with shape
(total_atoms, nao_max2).</p></li>
<li><p><strong>offsite_hamiltonian</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – Off-site Hamiltonian matrix elements with shape
(total_edges, nao_max2).</p></li>
<li><p><strong>onsite_overlap</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – Predicted on-site overlap matrix elements with shape
(total_atoms, nao_max2).</p></li>
<li><p><strong>offsite_overlap</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – Predicted off-site overlap matrix elements with shape
(total_edges, nao_max2).</p></li>
<li><p><strong>crystal_data</strong> (<em>DataObject</em>) – Object containing crystal structure information including:
- edge_index: Indices of connected atom pairs
- cell: Unit cell vectors
- z: Atomic numbers
- node_counts: Number of atoms in each crystal
- batch: Batch assignment for each atom
- k_vecs: k-points for band structure calculation
- nbr_shift: Neighbor cell shifts for periodic boundary conditions
- Son/Soff: Reference overlap matrices</p></li>
<li><p><strong>export_reciprocal_values</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to export additional reciprocal
space matrices (H(k), S(k), dS(k)). Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Contains band energies, wavefunctions, and optionally additional reciprocal space</dt><dd><p>matrices depending on the export_reciprocal_values parameter.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.calculate_band_energies">
<span class="sig-name descname"><span class="pre">calculate_band_energies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">onsite_hamiltonian</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offsite_hamiltonian</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crystal_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">export_reciprocal_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/hamgnn_output.html#HamGNNPlusPlusOut.calculate_band_energies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.calculate_band_energies" title="Link to this definition"></a></dt>
<dd><p>Calculate electronic band structure using Hamiltonian matrices and reference overlap matrices.</p>
<p>This function computes electronic band energies, wavefunctions, and band gaps for a set
of crystal structures by solving the generalized eigenvalue problem H���� = E��S����.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>onsite_hamiltonian</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – On-site Hamiltonian matrix elements with shape
(total_atoms, nao_max2).</p></li>
<li><p><strong>offsite_hamiltonian</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – Off-site Hamiltonian matrix elements with shape
(total_edges, nao_max2).</p></li>
<li><p><strong>crystal_data</strong> (<em>DataObject</em>) – Object containing crystal structure information including:
- edge_index: Indices of connected atom pairs
- cell: Unit cell vectors
- z: Atomic numbers
- node_counts: Number of atoms in each crystal
- batch: Batch assignment for each atom
- k_vecs: k-points for band structure calculation
- nbr_shift: Neighbor cell shifts for periodic boundary conditions
- Son/Soff: Reference overlap matrices</p></li>
<li><p><strong>export_reciprocal_values</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to export additional reciprocal
space matrices (H(k), S(k), dS(k)). Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Contains band energies, wavefunctions, band gaps, and optionally additional</dt><dd><p>reciprocal space matrices depending on the export_reciprocal_values parameter.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.calculate_band_energies_with_spin_orbit_coupling">
<span class="sig-name descname"><span class="pre">calculate_band_energies_with_spin_orbit_coupling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">real_onsite</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imag_onsite</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">real_offsite</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imag_offsite</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crystal_data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/hamgnn_output.html#HamGNNPlusPlusOut.calculate_band_energies_with_spin_orbit_coupling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.calculate_band_energies_with_spin_orbit_coupling" title="Link to this definition"></a></dt>
<dd><p>Calculate electronic band structure with spin-orbit coupling (SOC).</p>
<p>This function computes electronic band energies and wavefunctions for systems with
spin-orbit coupling, which requires handling complex Hamiltonian matrices and doubling
the matrix dimensions to account for spin.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>real_onsite</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – Real part of on-site SOC Hamiltonian with shape
(total_atoms, 2*nao_max, 2*nao_max).</p></li>
<li><p><strong>imag_onsite</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – Imaginary part of on-site SOC Hamiltonian with shape
(total_atoms, 2*nao_max, 2*nao_max).</p></li>
<li><p><strong>real_offsite</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – Real part of off-site SOC Hamiltonian with shape
(total_edges, 2*nao_max, 2*nao_max).</p></li>
<li><p><strong>imag_offsite</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – Imaginary part of off-site SOC Hamiltonian with shape
(total_edges, 2*nao_max, 2*nao_max).</p></li>
<li><p><strong>crystal_data</strong> (<em>DataObject</em>) – Object containing crystal structure information including:
- edge_index: Indices of connected atom pairs
- cell: Unit cell vectors
- z: Atomic numbers
- node_counts: Number of atoms in each crystal
- batch: Batch assignment for each atom
- k_vecs: k-points for band structure calculation
- cell_shift: Cell shift vectors for periodic images
- nbr_shift: Neighbor cell shifts for periodic boundary conditions
- Son/Soff: Reference overlap matrices (without SOC)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>(</dt><dd><p>band_energies (torch.Tensor): Band energies with shape (total_bands, num_k_points),
wavefunctions (torch.Tensor): Flattened wavefunctions</p>
</dd>
</dl>
<p>)</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.apply_orbital_masks_to_hamiltonians">
<span class="sig-name descname"><span class="pre">apply_orbital_masks_to_hamiltonians</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">onsite_hamiltonian</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offsite_hamiltonian</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_masks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/hamgnn_output.html#HamGNNPlusPlusOut.apply_orbital_masks_to_hamiltonians"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.apply_orbital_masks_to_hamiltonians" title="Link to this definition"></a></dt>
<dd><p>Apply atomic orbital validity masks to on-site and off-site Hamiltonian matrices.</p>
<p>This function zeroes out elements of Hamiltonian matrices that correspond to invalid
or non-existent atomic orbitals based on the atomic numbers. This ensures physical
correctness by preventing interactions involving orbitals that shouldn’t exist for
particular atom types.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>onsite_hamiltonian</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – On-site Hamiltonian matrix elements with shape
(n_atoms, nao_max^2) or (n_atoms, nao_max, nao_max).</p></li>
<li><p><strong>offsite_hamiltonian</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – Off-site Hamiltonian matrix elements with shape
(n_edges, nao_max^2) or (n_edges, nao_max, nao_max).</p></li>
<li><p><strong>data</strong> (<em>DataObject</em>) – Object containing:
- z: Atomic numbers for each atom
- edge_index: Indices of connected atom pairs (source, target)</p></li>
<li><p><strong>return_masks</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to return the masks along with masked
Hamiltonians. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl>
<dt>If return_masks is False:</dt><dd><p>(masked_onsite_hamiltonian, masked_offsite_hamiltonian)</p>
<p>If return_masks is True:
(masked_onsite_hamiltonian, masked_offsite_hamiltonian,</p>
<blockquote>
<div><p>onsite_orbital_mask, offsite_orbital_mask)</p>
</div></blockquote>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.symmetrize_orbital_coefficients">
<span class="sig-name descname"><span class="pre">symmetrize_orbital_coefficients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coefficient_matrix</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/hamgnn_output.html#HamGNNPlusPlusOut.symmetrize_orbital_coefficients"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.symmetrize_orbital_coefficients" title="Link to this definition"></a></dt>
<dd><p>Enforce spherical symmetry on orbital coefficient matrices by averaging within angular momentum blocks.</p>
<p>This function applies orbital symmetrization to ensure that coefficients maintain proper
rotational invariance within each angular momentum subspace (p, d, f orbitals). Each block
of coefficients corresponding to orbitals with the same angular momentum is averaged to
enforce spherical symmetry constraints.</p>
<p>Orbital index ranges by angular momentum:
- s orbitals: 0:3 (single orbital with additional indices)
- p orbitals: 3:6 (3 components)
- p’ orbitals: 6:9 (3 components)
- d orbitals: 9:14 (5 components)
- d’ orbitals: 14:19 (5 components, only for nao_max �� 19)
- f orbitals: 19:26 (7 components, only for nao_max = 26)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>coefficient_matrix</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – Coefficient matrix with shape (batch_size, nao_max2)
or (batch_size, nao_max, nao_max).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Symmetrized coefficient matrix with shape (batch_size, nao_max2).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.create_cell_index_mapping">
<span class="sig-name descname"><span class="pre">create_cell_index_mapping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unique_cell_vectors</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/hamgnn_output.html#HamGNNPlusPlusOut.create_cell_index_mapping"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.create_cell_index_mapping" title="Link to this definition"></a></dt>
<dd><p>Create a mapping from unique cell vectors to their indices.</p>
<p>This function creates a dictionary that associates each unique cell vector
(representing a unit cell in a periodic lattice) with its index in the list
of unique vectors. This mapping is used for efficient lookup of cell indices
when constructing Hamiltonian matrices with periodic boundary conditions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>unique_cell_vectors</strong> (<em>List</em><em>[</em><em>List</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em><em>]</em>) – A list of cell vectors, where each
vector is represented as a list of integers (typically 3 integers for
3D periodic systems).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary mapping each cell vector (as a tuple) to its integer index.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.extract_unique_cell_vectors">
<span class="sig-name descname"><span class="pre">extract_unique_cell_vectors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/hamgnn_output.html#HamGNNPlusPlusOut.extract_unique_cell_vectors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.extract_unique_cell_vectors" title="Link to this definition"></a></dt>
<dd><p>Extract unique cell vectors and create mappings for periodic boundary conditions.</p>
<p>This function processes cell shift data to:
1. Find all unique cell shift vectors
2. Ensure the zero vector (0,0,0) is included (required for on-site interactions)
3. Create a mapping from each cell shift to its unique index
4. Create an index array that maps each edge to its corresponding cell index</p>
<p>This information is essential for constructing Hamiltonian matrices with
proper periodic boundary conditions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>DataObject</em>) – <p>Object containing crystal structure information, including:
- cell_shift: Tensor of cell shift vectors for each edge, with shape</p>
<blockquote>
<div><p>(n_edges, 3), representing the periodic image shifts.</p>
</div></blockquote>
</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>unique_cell_vectors (torch.Tensor): Tensor of unique cell shift vectors
with shape (n_unique_cells, 3).</p></li>
<li><p>cell_vector_indices (torch.Tensor): Tensor mapping each edge to the
index of its corresponding unique cell vector, with shape (n_edges,).</p></li>
<li><p>cell_vector_map (dict): Dictionary mapping each cell vector tuple to
its index in unique_cell_vectors.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.build_edge_lookup_structures">
<span class="sig-name descname"><span class="pre">build_edge_lookup_structures</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inverse_edge_indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/hamgnn_output.html#HamGNNPlusPlusOut.build_edge_lookup_structures"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.build_edge_lookup_structures" title="Link to this definition"></a></dt>
<dd><p>Build efficient edge lookup structures for crystal graph operations.</p>
<p>This function constructs two data structures that enable fast edge lookup:
1. A mapping from each atom to all edges where that atom is the source
2. A mapping from each atom and cell shift combination to corresponding edges</p>
<p>These structures accelerate operations that require finding all edges connected
to specific atoms, particularly when periodic boundary conditions are involved.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>DataObject</em>) – Crystal graph data containing:
- edge_index: Tensor of shape [2, num_edges] with source and target indices
- unique_cell_shift: Tensor of unique cell shift vectors
- cell_shift_indices: Tensor mapping each edge to its cell shift index
- cell_index_map: Dictionary mapping cell shift tuples to indices
- z: Atomic numbers, used to determine number of atoms</p></li>
<li><p><strong>inverse_edge_indices</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a><em>, </em><em>optional</em>) – Tensor mapping each edge to its
inverse edge index (i��j maps to j��i). Required for building the target lookup.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>source_edge_indices (list of torch.Tensor): For each atom, contains indices
of edges where that atom is the source.</p></li>
<li><p>target_edge_indices (list of list of torch.Tensor): For each atom and cell
shift combination, contains indices of edges where that atom is the target
in the specified cell shift.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.create_orbital_validity_mask">
<span class="sig-name descname"><span class="pre">create_orbital_validity_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atomic_numbers</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/hamgnn_output.html#HamGNNPlusPlusOut.create_orbital_validity_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.create_orbital_validity_mask" title="Link to this definition"></a></dt>
<dd><p>Create a mask identifying valid atomic orbitals for each element type.</p>
<p>This function generates a binary mask tensor where each row corresponds to an
element in the periodic table (indexed by atomic number), and each column
represents an atomic orbital. A value of 1 indicates that the orbital is
valid for that element type, while 0 indicates an invalid orbital.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>atomic_numbers</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – Tensor containing atomic numbers, used only
for device and dtype information.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Binary mask tensor of shape (99, nao_max) where 99 covers</dt><dd><p>all possible elements in the periodic table and nao_max is the maximum
number of atomic orbitals.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.build_interaction_masks">
<span class="sig-name descname"><span class="pre">build_interaction_masks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/hamgnn_output.html#HamGNNPlusPlusOut.build_interaction_masks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.build_interaction_masks" title="Link to this definition"></a></dt>
<dd><p>Build boolean masks for valid orbital interactions in Hamiltonian matrices.</p>
<p>This function generates masks that identify which elements in the Hamiltonian
matrices correspond to valid orbital-orbital interactions, based on the atomic
species involved. It creates separate masks for on-site (same atom) and
off-site (different atoms) interactions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>DataObject</em>) – Graph data containing:
- edge_index: Indices of connected atom pairs
- z: Atomic numbers for each atom</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Combined mask tensor with shape (n_atoms + n_edges, nao_max2)</dt><dd><p>where the first n_atoms rows are for on-site interactions and the
remaining n_edges rows are for off-site interactions.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.build_column_wise_interaction_masks">
<span class="sig-name descname"><span class="pre">build_column_wise_interaction_masks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/hamgnn_output.html#HamGNNPlusPlusOut.build_column_wise_interaction_masks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.build_column_wise_interaction_masks" title="Link to this definition"></a></dt>
<dd><p>Build interaction masks with an additional column dimension.</p>
<p>Similar to build_interaction_masks, but creates masks with an additional
dimension for column-wise operations (e.g., for real and imaginary parts).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>DataObject</em>) – Graph data containing:
- edge_index: Indices of connected atom pairs
- z: Atomic numbers for each atom</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Combined mask tensor with shape</dt><dd><p>(n_atoms + n_edges, 2, nao_max2) where the additional
dimension can be used for real and imaginary parts.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.build_spin_orbit_interaction_masks">
<span class="sig-name descname"><span class="pre">build_spin_orbit_interaction_masks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/hamgnn_output.html#HamGNNPlusPlusOut.build_spin_orbit_interaction_masks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.build_spin_orbit_interaction_masks" title="Link to this definition"></a></dt>
<dd><p>Build interaction masks that account for spin-orbit coupling.</p>
<p>This function generates masks for systems with spin-orbit coupling, which
requires handling interactions between different spin components. The resulting
masks have double the orbital dimension to account for spin-up and spin-down
components.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>DataObject</em>) – Graph data containing:
- edge_index: Indices of connected atom pairs
- z: Atomic numbers for each atom</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing:</dt><dd><ul class="simple">
<li><p>real_imag_masks (torch.Tensor): Mask for real and imaginary
components with shape (n_atoms + n_edges, (2*nao_max)2)</p></li>
<li><p>combined_masks (torch.Tensor): Full mask tensor with shape
(2*(n_atoms + n_edges), (2*nao_max)2)</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.calculate_sparsity_ratio">
<span class="sig-name descname"><span class="pre">calculate_sparsity_ratio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/hamgnn_output.html#HamGNNPlusPlusOut.calculate_sparsity_ratio"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.calculate_sparsity_ratio" title="Link to this definition"></a></dt>
<dd><p>Calculate the ratio between the total possible matrix elements and the effective matrix elements.</p>
<p>This function computes the sparsity of Hamiltonian matrices by dividing the total number
of possible matrix elements by the number of effective matrix elements based on the
atomic basis definitions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><em>object</em></a>) – Data object containing atomic information and Hamiltonian matrices.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The sparsity ratio, defined as the total number of matrix elements
divided by the number of effective matrix elements. Returns infinity
if there are no effective elements.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The calculation considers both on-site and off-site Hamiltonian elements
if they are present in the data object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.validate_elements_in_basis_def">
<span class="sig-name descname"><span class="pre">validate_elements_in_basis_def</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raise_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/hamgnn_output.html#HamGNNPlusPlusOut.validate_elements_in_basis_def"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.validate_elements_in_basis_def" title="Link to this definition"></a></dt>
<dd><p>Validate that all elements in the input data exist in the basis_def dictionary.</p>
<p class="rubric">Notes</p>
<p>This function is used to ensure that all elements in the molecular system
have corresponding basis set definitions before performing calculations.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph_representation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/hamgnn_output.html#HamGNNPlusPlusOut.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.forward" title="Link to this definition"></a></dt>
<dd><p>Forward pass of the Hamiltonian prediction model.</p>
<p>This method constructs Hamiltonian matrices for crystal structures from graph representations,
with support for various physical effects including spin-orbit coupling (SOC), magnetism,
and long-range interactions. It can also calculate electronic band structures.</p>
<p>The method handles several different physical regimes:
1. Non-magnetic systems (standard DFT-like Hamiltonians)
2. Collinear spin-polarized systems (separate Hamiltonians for up/down spins)
3. Non-collinear magnetic systems (full 2x2 spin blocks with SOC)
4. Systems with spin-orbit coupling (complex Hamiltonians with real/imaginary parts)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>DataObject</em>) – Contains crystal structure information including:
- edge_index: Connectivity information between atoms
- z: Atomic numbers
- pos: Atomic positions
- cell: Unit cell vectors
- Hon/Hoff: Reference on-site/off-site Hamiltonian matrices (if available)
- Son/Soff: Reference on-site/off-site overlap matrices
- node_counts: Number of atoms in each crystal
- batch: Batch assignment for each atom
- inv_edge_idx: Inverse edge indices</p></li>
<li><p><strong>graph_representation</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>) – Output from the graph neural network containing:
- node_attr: Node feature vectors from the GNN
- edge_attr: Edge feature vectors from the GNN</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Dictionary containing predicted quantities, which may include:</dt><dd><ul class="simple">
<li><p>hamiltonian: Predicted Hamiltonian matrix</p></li>
<li><p>overlap: Predicted overlap matrix (if ham_only=False)</p></li>
<li><p>band_energy: Electronic band energies (if calculate_band_energy=True)</p></li>
<li><p>wavefunction: Eigenvectors of the Hamiltonian (if calculate_band_energy=True)</p></li>
<li><p>band_gap: Band gap values (if calculate_band_energy=True)</p></li>
<li><p>Various additional matrices for debugging or analysis</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The exact contents of the return dictionary depend on the model configuration
parameters (soc_switch, spin_constrained, collinear_spin, etc.)</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="module-HamGNN_v_2_1.models.Model">
<span id="main-model-implementation"></span><h2>Main Model Implementation<a class="headerlink" href="#module-HamGNN_v_2_1.models.Model" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.Model.Model">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_1.models.Model.</span></span><span class="sig-name descname"><span class="pre">Model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">representation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">losses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_monitor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'training/total_loss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.99</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.999</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amsgrad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_points_to_scatter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">post_processing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/Model.html#Model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.Model.Model" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">LightningModule</span></code></p>
<p>A PyTorch Lightning module for scientific machine learning models.</p>
<p>This class implements a modular architecture with representation and output components,
handles training, validation, and testing with customizable losses and metrics, and
supports gradient-based computations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>representation</strong> (<em>nn.Module</em>) – Neural network module that computes feature representations from input data</p></li>
<li><p><strong>output</strong> (<em>nn.Module</em>) – Neural network module that transforms representations into predictions</p></li>
<li><p><strong>losses</strong> (<em>List</em><em>[</em><em>Dict</em><em>]</em>) – List of dictionaries defining loss functions, their targets, predictions, and weights</p></li>
<li><p><strong>validation_metrics</strong> (<em>List</em><em>[</em><em>Dict</em><em>]</em>) – List of dictionaries defining metrics to track during validation</p></li>
<li><p><strong>lr</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>default=1e-3</em>) – Initial learning rate for optimizer</p></li>
<li><p><strong>lr_decay</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>default=0.1</em>) – Factor by which learning rate is reduced on plateau</p></li>
<li><p><strong>lr_patience</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default=100</em>) – Number of epochs with no improvement after which learning rate is reduced</p></li>
<li><p><strong>lr_monitor</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default=&quot;training/total_loss&quot;</em>) – Metric to monitor for learning rate scheduling</p></li>
<li><p><strong>epsilon</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>default=1e-8</em>) – Small constant for numerical stability in optimizer</p></li>
<li><p><strong>beta1</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>default=0.99</em>) – Exponential decay rate for first moment estimates in Adam optimizer</p></li>
<li><p><strong>beta2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>default=0.999</em>) – Exponential decay rate for second moment estimates in Adam optimizer</p></li>
<li><p><strong>amsgrad</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default=True</em>) – Whether to use AMSGrad variant of Adam optimizer</p></li>
<li><p><strong>max_points_to_scatter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default=100000</em>) – Maximum number of points to include in scatter plots</p></li>
<li><p><strong>post_processing</strong> (<em>callable</em><em>, </em><em>optional</em>) – Function for calculating additional physical quantities that may require gradient backpropagation</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.Model.Model.calculate_loss">
<span class="sig-name descname"><span class="pre">calculate_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/Model.html#Model.calculate_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.Model.Model.calculate_loss" title="Link to this definition"></a></dt>
<dd><p>Calculate the total loss by summing weighted individual loss components.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> (<em>Dict</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a><em>]</em>) – Dictionary containing input data and target values</p></li>
<li><p><strong>predictions</strong> (<em>Dict</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a><em>]</em>) – Dictionary containing model predictions</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Current mode (‘training’, ‘validation’, or ‘test’)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Total weighted loss</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.Model.Model.training_step">
<span class="sig-name descname"><span class="pre">training_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/Model.html#Model.training_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.Model.Model.training_step" title="Link to this definition"></a></dt>
<dd><p>Perform a single training step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> (<em>Dict</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a><em>]</em>) – Dictionary containing training data</p></li>
<li><p><strong>batch_idx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Index of the current batch</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Training loss for this step</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.Model.Model.validation_step">
<span class="sig-name descname"><span class="pre">validation_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/Model.html#Model.validation_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.Model.Model.validation_step" title="Link to this definition"></a></dt>
<dd><p>Perform a single validation step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> (<em>Dict</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a><em>]</em>) – Dictionary containing validation data</p></li>
<li><p><strong>batch_idx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Index of the current batch</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing predictions and targets for logging</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.Model.Model.validation_epoch_end">
<span class="sig-name descname"><span class="pre">validation_epoch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">validation_step_outputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/Model.html#Model.validation_epoch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.Model.Model.validation_epoch_end" title="Link to this definition"></a></dt>
<dd><p>Process and log validation results at the end of an epoch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>validation_step_outputs</strong> (<em>List</em><em>[</em><em>Dict</em><em>]</em>) – List of outputs from all validation steps in the epoch</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.Model.Model.test_step">
<span class="sig-name descname"><span class="pre">test_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/Model.html#Model.test_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.Model.Model.test_step" title="Link to this definition"></a></dt>
<dd><p>Perform a single test step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> (<em>Dict</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a><em>]</em>) – Dictionary containing test data</p></li>
<li><p><strong>batch_idx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Index of the current batch</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing predictions, targets, and processed values</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.Model.Model.test_epoch_end">
<span class="sig-name descname"><span class="pre">test_epoch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test_step_outputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/Model.html#Model.test_epoch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.Model.Model.test_epoch_end" title="Link to this definition"></a></dt>
<dd><p>Process and log test results at the end of testing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>test_step_outputs</strong> (<em>List</em><em>[</em><em>Dict</em><em>]</em>) – List of outputs from all test steps</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.Model.Model.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/Model.html#Model.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.Model.Model.forward" title="Link to this definition"></a></dt>
<dd><p>Forward pass through the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch</strong> (<em>Dict</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a><em>]</em>) – Dictionary containing input data</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing model predictions</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, <a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)">torch.Tensor</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.Model.Model.log_metrics">
<span class="sig-name descname"><span class="pre">log_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/Model.html#Model.log_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.Model.Model.log_metrics" title="Link to this definition"></a></dt>
<dd><p>Log evaluation metrics for the current batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> (<em>Dict</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a><em>]</em>) – Dictionary containing input data and target values</p></li>
<li><p><strong>predictions</strong> (<em>Dict</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a><em>]</em>) – Dictionary containing model predictions</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Current mode (‘validation’ or ‘test’)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.models.Model.Model.configure_optimizers">
<span class="sig-name descname"><span class="pre">configure_optimizers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_1/models/Model.html#Model.configure_optimizers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.models.Model.Model.configure_optimizers" title="Link to this definition"></a></dt>
<dd><p>Configure optimizers and learning rate schedulers.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Configuration dictionary for PyTorch Lightning</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../user_guide/parameters.html" class="btn btn-neutral float-left" title="HamGNN Parameter Details" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="gnn_core.html" class="btn btn-neutral float-right" title="GNN Core Layers" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright HamGNN Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"></span>
    docs | v2.1 | en
    <span class="fa fa-caret-down"></span>
  </span>
  
  <div class="rst-other-versions">
    
    
    
    
    
    
    
    

    <hr>
    <dl>
      <dt>项目主页</dt>
      <dd>
        <a href="https://github.com/bud-primordium/HamGNN">
          <span class="fa fa-github"></span> GitHub
        </a>
      </dd>
    </dl>
  </div>
</div>

<style>
/* 自定义样式优化三维切换器 */
.rst-versions {
  font-size: 14px;
}

/* 让版本切换器更醒目 */
.rst-current-version {
  background-color: #2c3e50 !important;
  font-weight: bold !important;
  font-size: 15px !important;
  padding: 12px 24px !important;
}

.rst-current-version:hover {
  background-color: #34495e !important;
}

.rst-other-versions dl {
  margin-bottom: 16px;
}

.rst-other-versions dt {
  color: #55a5d9;
  font-weight: bold;
  margin-bottom: 8px;
}

.rst-other-versions dd {
  margin-left: 16px;
  margin-bottom: 4px;
}

.rst-other-versions dd.rtd-current-item a {
  font-weight: bold;
  color: #55a5d9;
}

.rst-other-versions hr {
  margin: 16px 0;
  border: none;
  border-top: 1px solid #444;
}
</style><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>