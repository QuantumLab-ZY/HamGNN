

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Attention Mechanisms &mdash; HamGNN v2.1 Documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=fd3f3429" />
      <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=7902463a" />

  
    <link rel="shortcut icon" href="../../_static/logo.png"/>
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=c36237e0"></script>
      <script src="../../_static/doctools.js?v=9a2dae69"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../_static/copybutton.js?v=faab29de"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Convolution Layers" href="convolution.html" />
    <link rel="prev" title="Message Passing" href="message_passing.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #2980B9" >

          
          
          <a href="../../index.html" class="icon icon-home">
            HamGNN_v_2_1
              <img src="../../_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../user_guide/index.html">HamGNN User Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/introduction.html">HamGNN Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/introduction.html#key-features">Key Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/introduction.html#application-areas">Application Areas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/introduction.html#latest-developments">Latest Developments</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/installation.html">Environment Configuration and Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/installation.html#python-environment">Python Environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/installation.html#third-party-dft-tool-support">Third-party DFT Tool Support</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/installation.html#openmx">OpenMX</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/installation.html#siesta-honpas">SIESTA/HONPAS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/installation.html#abacus">ABACUS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/installation.html#compiling-openmx-postprocess-and-read-openmx">Compiling <code class="docutils literal notranslate"><span class="pre">openmx_postprocess</span></code> and <code class="docutils literal notranslate"><span class="pre">read_openmx</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/installation.html#hamgnn-installation-steps">HamGNN Installation Steps</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/installation.html#step-one-install-conda-environment">Step One: Install Conda Environment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/installation.html#step-two-source-installation-of-hamgnn">Step Two: Source Installation of HamGNN</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/data_preparation.html">Construction of graph_data.npz File</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/data_preparation.html#general-process">General Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/data_preparation.html#openmx-process">OpenMX Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/data_preparation.html#siesta-honpas-process">SIESTA/HONPAS Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/data_preparation.html#abacus-process">ABACUS Process</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/training.html">Model Training Process</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/training.html#training-mode-classification">Training Mode Classification</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/training.html#training-command">Training Command</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/training.html#key-configuration-items">Key Configuration Items</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/training.html#training-monitoring">Training Monitoring</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/prediction.html">Model Prediction Operation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/prediction.html#preparation-for-prediction">Preparation for Prediction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/prediction.html#execute-prediction">Execute Prediction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/prediction.html#output-results">Output Results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/band_calculation.html">Band Structure Calculation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/band_calculation.html#operation-process">Operation Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/band_calculation.html#band-calculation-for-large-systems">Band Calculation for Large Systems</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/uni_hamgnn.html">Uni-HamGNN Universal Model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/uni_hamgnn.html#model-introduction">Model Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/uni_hamgnn.html#input-requirements">Input Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/uni_hamgnn.html#usage-process">Usage Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/uni_hamgnn.html#output-results">Output Results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/parameters.html">HamGNN Parameter Details</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/parameters.html#setup-basic-settings">setup (Basic Settings)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/parameters.html#dataset-params-dataset-parameters">dataset_params (Dataset Parameters)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/parameters.html#losses-metrics-loss-functions-and-evaluation-metrics">losses_metrics (Loss Functions and Evaluation Metrics)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/parameters.html#optim-params-optimizer-parameters">optim_params (Optimizer Parameters)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/parameters.html#output-nets-hamgnn-out-output-network-parameters">output_nets.HamGNN_out (Output Network Parameters)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/parameters.html#representation-nets-hamgnn-pre-representation-network-parameters">representation_nets.HamGNN_pre (Representation Network Parameters)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/parameters.html#parameter-adjustment-recommendations">Parameter Adjustment Recommendations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/parameters.html#references">References</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../model_structure.html">Model Structure</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../model_structure.html#module-HamGNN_v_2_1.models.base_model">Base Model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.base_model.get_radii_from_atomic_numbers"><code class="docutils literal notranslate"><span class="pre">get_radii_from_atomic_numbers()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.base_model.neighbor_list_and_relative_vec"><code class="docutils literal notranslate"><span class="pre">neighbor_list_and_relative_vec()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.base_model.find_matching_columns_of_A_in_B"><code class="docutils literal notranslate"><span class="pre">find_matching_columns_of_A_in_B()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.base_model.BaseModel"><code class="docutils literal notranslate"><span class="pre">BaseModel</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.base_model.BaseModel.forward"><code class="docutils literal notranslate"><span class="pre">BaseModel.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.base_model.BaseModel.generate_graph"><code class="docutils literal notranslate"><span class="pre">BaseModel.generate_graph()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.base_model.BaseModel.num_params"><code class="docutils literal notranslate"><span class="pre">BaseModel.num_params</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../model_structure.html#module-HamGNN_v_2_1.models.hamgnn_conv">HamGNN Convolution</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.hamgnn_conv.HamGNNConvE3"><code class="docutils literal notranslate"><span class="pre">HamGNNConvE3</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.hamgnn_conv.HamGNNConvE3.forward"><code class="docutils literal notranslate"><span class="pre">HamGNNConvE3.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../model_structure.html#module-HamGNN_v_2_1.models.hamgnn_transformer">HamGNN Transformer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.hamgnn_transformer.HamGNNTransformer"><code class="docutils literal notranslate"><span class="pre">HamGNNTransformer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.hamgnn_transformer.HamGNNTransformer.forward"><code class="docutils literal notranslate"><span class="pre">HamGNNTransformer.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../model_structure.html#module-HamGNN_v_2_1.models.hamgnn_output">HamGNN Output Head</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.hamgnn_output.HamLayer"><code class="docutils literal notranslate"><span class="pre">HamLayer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.hamgnn_output.HamLayer.forward"><code class="docutils literal notranslate"><span class="pre">HamLayer.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.merge_tensor_components"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.merge_tensor_components()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.merge_rank2_tensor_components"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.merge_rank2_tensor_components()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.merge_rank0_tensor_components"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.merge_rank0_tensor_components()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.construct_j_coupling_matrix"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.construct_j_coupling_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.construct_k_coupling_matrix"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.construct_k_coupling_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.reorder_matrix"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.reorder_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.construct_molecular_hamiltonian"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.construct_molecular_hamiltonian()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.concatenate_hamiltonians_by_crystal"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.concatenate_hamiltonians_by_crystal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.symmetrize_hamiltonian"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.symmetrize_hamiltonian()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.symmetrize_onsite_hamiltonian"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.symmetrize_onsite_hamiltonian()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.symmetrize_offsite_hamiltonian"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.symmetrize_offsite_hamiltonian()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.symmetrize_onsite_hamiltonian_soc"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.symmetrize_onsite_hamiltonian_soc()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.symmetrize_offsite_hamiltonian_soc"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.symmetrize_offsite_hamiltonian_soc()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.calculate_band_energies_with_overlap"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.calculate_band_energies_with_overlap()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.calculate_band_energies"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.calculate_band_energies()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.calculate_band_energies_with_spin_orbit_coupling"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.calculate_band_energies_with_spin_orbit_coupling()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.apply_orbital_masks_to_hamiltonians"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.apply_orbital_masks_to_hamiltonians()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.symmetrize_orbital_coefficients"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.symmetrize_orbital_coefficients()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.create_cell_index_mapping"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.create_cell_index_mapping()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.extract_unique_cell_vectors"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.extract_unique_cell_vectors()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.build_edge_lookup_structures"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.build_edge_lookup_structures()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.create_orbital_validity_mask"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.create_orbital_validity_mask()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.build_interaction_masks"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.build_interaction_masks()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.build_column_wise_interaction_masks"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.build_column_wise_interaction_masks()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.build_spin_orbit_interaction_masks"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.build_spin_orbit_interaction_masks()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.calculate_sparsity_ratio"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.calculate_sparsity_ratio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.validate_elements_in_basis_def"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.validate_elements_in_basis_def()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.hamgnn_output.HamGNNPlusPlusOut.forward"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../model_structure.html#module-HamGNN_v_2_1.models.Model">Main Model Implementation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.Model.Model"><code class="docutils literal notranslate"><span class="pre">Model</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.Model.Model.calculate_loss"><code class="docutils literal notranslate"><span class="pre">Model.calculate_loss()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.Model.Model.training_step"><code class="docutils literal notranslate"><span class="pre">Model.training_step()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.Model.Model.validation_step"><code class="docutils literal notranslate"><span class="pre">Model.validation_step()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.Model.Model.validation_epoch_end"><code class="docutils literal notranslate"><span class="pre">Model.validation_epoch_end()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.Model.Model.test_step"><code class="docutils literal notranslate"><span class="pre">Model.test_step()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.Model.Model.test_epoch_end"><code class="docutils literal notranslate"><span class="pre">Model.test_epoch_end()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.Model.Model.forward"><code class="docutils literal notranslate"><span class="pre">Model.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.Model.Model.log_metrics"><code class="docutils literal notranslate"><span class="pre">Model.log_metrics()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_structure.html#HamGNN_v_2_1.models.Model.Model.configure_optimizers"><code class="docutils literal notranslate"><span class="pre">Model.configure_optimizers()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../gnn_core.html">GNN Core Layers</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="message_passing.html">Message Passing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="message_passing.html#module-HamGNN_v_2_1.nn.message_passing">Message Pack Blocks</a><ul>
<li class="toctree-l4"><a class="reference internal" href="message_passing.html#HamGNN_v_2_1.nn.message_passing.MessagePackBlock"><code class="docutils literal notranslate"><span class="pre">MessagePackBlock</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="message_passing.html#HamGNN_v_2_1.nn.message_passing.MessagePackBlockV2"><code class="docutils literal notranslate"><span class="pre">MessagePackBlockV2</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Attention Mechanisms</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-HamGNN_v_2_1.nn.attention">Attention Layers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.nn.attention.AttentionAggregationV2"><code class="docutils literal notranslate"><span class="pre">AttentionAggregationV2</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.nn.attention.AttentionAggregation"><code class="docutils literal notranslate"><span class="pre">AttentionAggregation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.nn.attention.AttentionBlockE3"><code class="docutils literal notranslate"><span class="pre">AttentionBlockE3</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-HamGNN_v_2_1.nn.attention_utils">Attention Utilities</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.nn.attention_utils.VectorToAttentionHeads"><code class="docutils literal notranslate"><span class="pre">VectorToAttentionHeads</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_1.nn.attention_utils.AttentionHeadsToVector"><code class="docutils literal notranslate"><span class="pre">AttentionHeadsToVector</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="convolution.html">Convolution Layers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="convolution.html#module-HamGNN_v_2_1.nn.convolution">Graph Convolution Operations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="convolution.html#HamGNN_v_2_1.nn.convolution.ConvBlockE3"><code class="docutils literal notranslate"><span class="pre">ConvBlockE3</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tensor_operations.html">Tensor Operations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tensor_operations.html#module-HamGNN_v_2_1.nn.tensor_products">Tensor Products</a><ul>
<li class="toctree-l4"><a class="reference internal" href="tensor_operations.html#HamGNN_v_2_1.nn.tensor_products.LinearScaleWithWeights"><code class="docutils literal notranslate"><span class="pre">LinearScaleWithWeights</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="tensor_operations.html#HamGNN_v_2_1.nn.tensor_products.TensorProductWithMemoryOptimizationWithWeight"><code class="docutils literal notranslate"><span class="pre">TensorProductWithMemoryOptimizationWithWeight</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="tensor_operations.html#HamGNN_v_2_1.nn.tensor_products.TensorProductWithScalarComponents"><code class="docutils literal notranslate"><span class="pre">TensorProductWithScalarComponents</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="tensor_operations.html#HamGNN_v_2_1.nn.tensor_products.ConcatenatedIrrepsTensorProduct"><code class="docutils literal notranslate"><span class="pre">ConcatenatedIrrepsTensorProduct</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="interaction_blocks.html">Interaction Blocks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="interaction_blocks.html#module-HamGNN_v_2_1.nn.interaction_blocks">Neural Network Interaction Components</a><ul>
<li class="toctree-l4"><a class="reference internal" href="interaction_blocks.html#HamGNN_v_2_1.nn.interaction_blocks.PairInteractionBlock"><code class="docutils literal notranslate"><span class="pre">PairInteractionBlock</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="interaction_blocks.html#HamGNN_v_2_1.nn.interaction_blocks.CorrProductBlock"><code class="docutils literal notranslate"><span class="pre">CorrProductBlock</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="interaction_blocks.html#HamGNN_v_2_1.nn.interaction_blocks.ResidualBlock"><code class="docutils literal notranslate"><span class="pre">ResidualBlock</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="physics_tools.html">Physics Tools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="physics_tools.html#module-HamGNN_v_2_1.physics.Clebsch_Gordan_coefficients">Clebsch-Gordan Coefficients</a><ul>
<li class="toctree-l4"><a class="reference internal" href="physics_tools.html#HamGNN_v_2_1.physics.Clebsch_Gordan_coefficients.ClebschGordanCoefficients"><code class="docutils literal notranslate"><span class="pre">ClebschGordanCoefficients</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="physics_tools.html#module-HamGNN_v_2_1.physics.kpoints">K-Points</a><ul>
<li class="toctree-l4"><a class="reference internal" href="physics_tools.html#HamGNN_v_2_1.physics.kpoints.kpoints_generator"><code class="docutils literal notranslate"><span class="pre">kpoints_generator</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="physics_tools.html#HamGNN_v_2_1.physics.kpoints.compute_reciprocal_lattice_vectors"><code class="docutils literal notranslate"><span class="pre">compute_reciprocal_lattice_vectors()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="physics_tools.html#HamGNN_v_2_1.physics.kpoints.generate_kpoint_grid"><code class="docutils literal notranslate"><span class="pre">generate_kpoint_grid()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="physics_tools.html#module-HamGNN_v_2_1.physics.matrix_operations">Matrix Operations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="physics_tools.html#HamGNN_v_2_1.physics.matrix_operations.HamLayer"><code class="docutils literal notranslate"><span class="pre">HamLayer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="physics_tools.html#HamGNN_v_2_1.physics.matrix_operations.TensorExpansion"><code class="docutils literal notranslate"><span class="pre">TensorExpansion</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="physics_tools.html#HamGNN_v_2_1.physics.matrix_operations.OverlapExpand"><code class="docutils literal notranslate"><span class="pre">OverlapExpand</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="physics_tools.html#HamGNN_v_2_1.physics.matrix_operations.TensorMerge"><code class="docutils literal notranslate"><span class="pre">TensorMerge</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../model_components.html">Model Components</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../model_components.html#module-HamGNN_v_2_1.nn.embeddings">Embeddings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.nn.embeddings.RadialBasisEdgeEncoding"><code class="docutils literal notranslate"><span class="pre">RadialBasisEdgeEncoding</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.nn.embeddings.RadialBasisEdgeEncoding.out_field"><code class="docutils literal notranslate"><span class="pre">RadialBasisEdgeEncoding.out_field</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.nn.embeddings.RadialBasisEdgeEncoding.forward"><code class="docutils literal notranslate"><span class="pre">RadialBasisEdgeEncoding.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.nn.embeddings.EdgeScalarEmbedding"><code class="docutils literal notranslate"><span class="pre">EdgeScalarEmbedding</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.nn.embeddings.EdgeScalarEmbedding.forward"><code class="docutils literal notranslate"><span class="pre">EdgeScalarEmbedding.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.nn.embeddings.LocalEnvironmentEmbedding"><code class="docutils literal notranslate"><span class="pre">LocalEnvironmentEmbedding</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.nn.embeddings.LocalEnvironmentEmbedding.forward"><code class="docutils literal notranslate"><span class="pre">LocalEnvironmentEmbedding.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.nn.embeddings.PairInteractionEmbeddingBlock"><code class="docutils literal notranslate"><span class="pre">PairInteractionEmbeddingBlock</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.nn.embeddings.PairInteractionEmbeddingBlock.create_linear"><code class="docutils literal notranslate"><span class="pre">PairInteractionEmbeddingBlock.create_linear()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.nn.embeddings.PairInteractionEmbeddingBlock.create_tensor_product"><code class="docutils literal notranslate"><span class="pre">PairInteractionEmbeddingBlock.create_tensor_product()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.nn.embeddings.PairInteractionEmbeddingBlock.init_weight_generator"><code class="docutils literal notranslate"><span class="pre">PairInteractionEmbeddingBlock.init_weight_generator()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.nn.embeddings.PairInteractionEmbeddingBlock.forward"><code class="docutils literal notranslate"><span class="pre">PairInteractionEmbeddingBlock.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.nn.embeddings.Embedding"><code class="docutils literal notranslate"><span class="pre">Embedding</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.nn.embeddings.Embedding.reset_parameters"><code class="docutils literal notranslate"><span class="pre">Embedding.reset_parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.nn.embeddings.Embedding.forward"><code class="docutils literal notranslate"><span class="pre">Embedding.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../model_components.html#module-HamGNN_v_2_1.nn.electron_configurations">Electron Configurations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model_components.html#module-HamGNN_v_2_1.utils.mlp">MLP Utilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.mlp.linear_bn_act"><code class="docutils literal notranslate"><span class="pre">linear_bn_act()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.mlp.denseLayer"><code class="docutils literal notranslate"><span class="pre">denseLayer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.mlp.denseLayer.forward"><code class="docutils literal notranslate"><span class="pre">denseLayer.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.mlp.Dense"><code class="docutils literal notranslate"><span class="pre">Dense</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.mlp.Dense.reset_parameters"><code class="docutils literal notranslate"><span class="pre">Dense.reset_parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.mlp.Dense.forward"><code class="docutils literal notranslate"><span class="pre">Dense.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../model_components.html#module-HamGNN_v_2_1.utils.activation">Activation Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.activation.shifted_softplus"><code class="docutils literal notranslate"><span class="pre">shifted_softplus()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.activation.switch_function"><code class="docutils literal notranslate"><span class="pre">switch_function()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.activation.softplus_inverse"><code class="docutils literal notranslate"><span class="pre">softplus_inverse()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.activation.SoftUnitStepCutoff"><code class="docutils literal notranslate"><span class="pre">SoftUnitStepCutoff</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.activation.SoftUnitStepCutoff.cutoff"><code class="docutils literal notranslate"><span class="pre">SoftUnitStepCutoff.cutoff</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.activation.SoftUnitStepCutoff.cut_param"><code class="docutils literal notranslate"><span class="pre">SoftUnitStepCutoff.cut_param</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.activation.SoftUnitStepCutoff.forward"><code class="docutils literal notranslate"><span class="pre">SoftUnitStepCutoff.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.activation.swish"><code class="docutils literal notranslate"><span class="pre">swish()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.activation.SSP"><code class="docutils literal notranslate"><span class="pre">SSP</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.activation.SSP.forward"><code class="docutils literal notranslate"><span class="pre">SSP.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.activation.SSP.extra_repr"><code class="docutils literal notranslate"><span class="pre">SSP.extra_repr()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.activation.SWISH"><code class="docutils literal notranslate"><span class="pre">SWISH</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.activation.SWISH.forward"><code class="docutils literal notranslate"><span class="pre">SWISH.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.activation.get_activation"><code class="docutils literal notranslate"><span class="pre">get_activation()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../model_components.html#module-HamGNN_v_2_1.utils.basis_functions">Basis Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.basis_functions.BernsteinRadialBasisFunctions"><code class="docutils literal notranslate"><span class="pre">BernsteinRadialBasisFunctions</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.basis_functions.BernsteinRadialBasisFunctions.reset_parameters"><code class="docutils literal notranslate"><span class="pre">BernsteinRadialBasisFunctions.reset_parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.basis_functions.BernsteinRadialBasisFunctions.forward"><code class="docutils literal notranslate"><span class="pre">BernsteinRadialBasisFunctions.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.basis_functions.ExponentialBernsteinRadialBasisFunctions"><code class="docutils literal notranslate"><span class="pre">ExponentialBernsteinRadialBasisFunctions</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.basis_functions.ExponentialBernsteinRadialBasisFunctions.reset_parameters"><code class="docutils literal notranslate"><span class="pre">ExponentialBernsteinRadialBasisFunctions.reset_parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.basis_functions.ExponentialBernsteinRadialBasisFunctions.forward"><code class="docutils literal notranslate"><span class="pre">ExponentialBernsteinRadialBasisFunctions.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.basis_functions.ExponentialGaussianRadialBasisFunctions"><code class="docutils literal notranslate"><span class="pre">ExponentialGaussianRadialBasisFunctions</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.basis_functions.ExponentialGaussianRadialBasisFunctions.reset_parameters"><code class="docutils literal notranslate"><span class="pre">ExponentialGaussianRadialBasisFunctions.reset_parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.basis_functions.ExponentialGaussianRadialBasisFunctions.forward"><code class="docutils literal notranslate"><span class="pre">ExponentialGaussianRadialBasisFunctions.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.basis_functions.GaussianRadialBasisFunctions"><code class="docutils literal notranslate"><span class="pre">GaussianRadialBasisFunctions</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.basis_functions.GaussianRadialBasisFunctions.reset_parameters"><code class="docutils literal notranslate"><span class="pre">GaussianRadialBasisFunctions.reset_parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.basis_functions.GaussianRadialBasisFunctions.forward"><code class="docutils literal notranslate"><span class="pre">GaussianRadialBasisFunctions.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.basis_functions.OverlapBernsteinRadialBasisFunctions"><code class="docutils literal notranslate"><span class="pre">OverlapBernsteinRadialBasisFunctions</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.basis_functions.OverlapBernsteinRadialBasisFunctions.reset_parameters"><code class="docutils literal notranslate"><span class="pre">OverlapBernsteinRadialBasisFunctions.reset_parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.basis_functions.OverlapBernsteinRadialBasisFunctions.forward"><code class="docutils literal notranslate"><span class="pre">OverlapBernsteinRadialBasisFunctions.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.basis_functions.sph_harm_layer"><code class="docutils literal notranslate"><span class="pre">sph_harm_layer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.basis_functions.sph_harm_layer.forward"><code class="docutils literal notranslate"><span class="pre">sph_harm_layer.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.basis_functions.BesselBasis"><code class="docutils literal notranslate"><span class="pre">BesselBasis</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.basis_functions.BesselBasis.forward"><code class="docutils literal notranslate"><span class="pre">BesselBasis.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.basis_functions.GaussianSmearing"><code class="docutils literal notranslate"><span class="pre">GaussianSmearing</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.basis_functions.GaussianSmearing.forward"><code class="docutils literal notranslate"><span class="pre">GaussianSmearing.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../model_components.html#module-HamGNN_v_2_1.utils.cutoff_functions">Cutoff Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.cutoff_functions.cutoff_function"><code class="docutils literal notranslate"><span class="pre">cutoff_function()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.cutoff_functions.cuttoff_envelope"><code class="docutils literal notranslate"><span class="pre">cuttoff_envelope</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.cutoff_functions.cuttoff_envelope.forward"><code class="docutils literal notranslate"><span class="pre">cuttoff_envelope.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.cutoff_functions.CosineCutoff"><code class="docutils literal notranslate"><span class="pre">CosineCutoff</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.cutoff_functions.CosineCutoff.forward"><code class="docutils literal notranslate"><span class="pre">CosineCutoff.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.cutoff_functions.SoftUnitStepCutoff"><code class="docutils literal notranslate"><span class="pre">SoftUnitStepCutoff</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.cutoff_functions.SoftUnitStepCutoff.cutoff"><code class="docutils literal notranslate"><span class="pre">SoftUnitStepCutoff.cutoff</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.cutoff_functions.SoftUnitStepCutoff.cut_param"><code class="docutils literal notranslate"><span class="pre">SoftUnitStepCutoff.cut_param</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.cutoff_functions.SoftUnitStepCutoff.forward"><code class="docutils literal notranslate"><span class="pre">SoftUnitStepCutoff.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../model_components.html#module-HamGNN_v_2_1.utils.regression_layers">Regression Layers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.regression_layers.denseRegression"><code class="docutils literal notranslate"><span class="pre">denseRegression</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.regression_layers.denseRegression.forward"><code class="docutils literal notranslate"><span class="pre">denseRegression.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.regression_layers.MLPRegression"><code class="docutils literal notranslate"><span class="pre">MLPRegression</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.regression_layers.MLPRegression.forward"><code class="docutils literal notranslate"><span class="pre">MLPRegression.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../model_components.html#module-HamGNN_v_2_1.utils.hparam">Hyperparameter Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../model_components.html#HamGNN_v_2_1.utils.hparam.get_hparam_dict"><code class="docutils literal notranslate"><span class="pre">get_hparam_dict()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../data_processing.html">Data Processing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../data_processing.html#graph-data">Graph Data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../configuration.html">Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../configuration.html#module-HamGNN_v_2_1.config.config_parsing">Config Parsing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../configuration.html#HamGNN_v_2_1.config.config_parsing.config_default"><code class="docutils literal notranslate"><span class="pre">config_default</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration.html#HamGNN_v_2_1.config.config_parsing.recursive_update"><code class="docutils literal notranslate"><span class="pre">recursive_update()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration.html#HamGNN_v_2_1.config.config_parsing.load_config"><code class="docutils literal notranslate"><span class="pre">load_config()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../utilities.html">Utilities</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../utilities.html#module-HamGNN_v_2_1.utils.irreps_utils">Irreps Utilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../utilities.html#HamGNN_v_2_1.utils.irreps_utils.extract_scalar_irreps"><code class="docutils literal notranslate"><span class="pre">extract_scalar_irreps()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utilities.html#HamGNN_v_2_1.utils.irreps_utils.irreps2gate"><code class="docutils literal notranslate"><span class="pre">irreps2gate()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utilities.html#HamGNN_v_2_1.utils.irreps_utils.scale_irreps"><code class="docutils literal notranslate"><span class="pre">scale_irreps()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utilities.html#HamGNN_v_2_1.utils.irreps_utils.filter_and_split_irreps"><code class="docutils literal notranslate"><span class="pre">filter_and_split_irreps()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../utilities.html#module-HamGNN_v_2_1.utils.triplets">Triplets</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../utilities.html#HamGNN_v_2_1.utils.triplets.triplets"><code class="docutils literal notranslate"><span class="pre">triplets()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../utilities.html#module-HamGNN_v_2_1.utils.math_utils">Math Utilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../utilities.html#HamGNN_v_2_1.utils.math_utils.count_neighbors_per_node"><code class="docutils literal notranslate"><span class="pre">count_neighbors_per_node()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utilities.html#HamGNN_v_2_1.utils.math_utils.prod"><code class="docutils literal notranslate"><span class="pre">prod()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utilities.html#HamGNN_v_2_1.utils.math_utils.blockwise_2x2_concat"><code class="docutils literal notranslate"><span class="pre">blockwise_2x2_concat()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utilities.html#HamGNN_v_2_1.utils.math_utils.extract_elements_above_threshold"><code class="docutils literal notranslate"><span class="pre">extract_elements_above_threshold()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utilities.html#HamGNN_v_2_1.utils.math_utils.upgrade_tensor_precision"><code class="docutils literal notranslate"><span class="pre">upgrade_tensor_precision()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../utilities.html#module-HamGNN_v_2_1.utils.losses">Loss Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../utilities.html#HamGNN_v_2_1.utils.losses.cosine_similarity_loss"><code class="docutils literal notranslate"><span class="pre">cosine_similarity_loss</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utilities.html#HamGNN_v_2_1.utils.losses.cosine_similarity_loss.forward"><code class="docutils literal notranslate"><span class="pre">cosine_similarity_loss.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utilities.html#HamGNN_v_2_1.utils.losses.sum_zero_loss"><code class="docutils literal notranslate"><span class="pre">sum_zero_loss</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utilities.html#HamGNN_v_2_1.utils.losses.sum_zero_loss.forward"><code class="docutils literal notranslate"><span class="pre">sum_zero_loss.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utilities.html#HamGNN_v_2_1.utils.losses.Euclidean_loss"><code class="docutils literal notranslate"><span class="pre">Euclidean_loss</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utilities.html#HamGNN_v_2_1.utils.losses.Euclidean_loss.forward"><code class="docutils literal notranslate"><span class="pre">Euclidean_loss.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utilities.html#HamGNN_v_2_1.utils.losses.RMSELoss"><code class="docutils literal notranslate"><span class="pre">RMSELoss</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utilities.html#HamGNN_v_2_1.utils.losses.RMSELoss.forward"><code class="docutils literal notranslate"><span class="pre">RMSELoss.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utilities.html#HamGNN_v_2_1.utils.losses.parse_metric_func"><code class="docutils literal notranslate"><span class="pre">parse_metric_func()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../utilities.html#module-HamGNN_v_2_1.utils.visualization">Visualization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../utilities.html#HamGNN_v_2_1.utils.visualization.scatter_plot"><code class="docutils literal notranslate"><span class="pre">scatter_plot()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #2980B9" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">HamGNN_v_2_1</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../gnn_core.html">GNN Core Layers</a></li>
      <li class="breadcrumb-item active">Attention Mechanisms</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/bud-primordium/HamGNN_2_1_temp/blob/main/docs/api/gnn_core/attention.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="message_passing.html" class="btn btn-neutral float-left" title="Message Passing" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="convolution.html" class="btn btn-neutral float-right" title="Convolution Layers" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="attention-mechanisms">
<h1>Attention Mechanisms<a class="headerlink" href="#attention-mechanisms" title="Link to this heading"></a></h1>
<section id="module-HamGNN_v_2_1.nn.attention">
<span id="attention-layers"></span><h2>Attention Layers<a class="headerlink" href="#module-HamGNN_v_2_1.nn.attention" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="HamGNN_v_2_1.nn.attention.AttentionAggregationV2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_1.nn.attention.</span></span><span class="sig-name descname"><span class="pre">AttentionAggregationV2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_heads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/HamGNN_v_2_1/nn/attention.html#AttentionAggregationV2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.nn.attention.AttentionAggregationV2" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></p>
<p>An equivariant attention mechanism that processes key, value, and query vectors
and applies attention across edges in a graph.</p>
<p>Parameters:
- num_heads (int): Number of attention heads.
- irreps_value (o3.Irreps): Irreducible representations for value vectors.</p>
<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.nn.attention.AttentionAggregationV2.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_weights_cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/HamGNN_v_2_1/nn/attention.html#AttentionAggregationV2.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.nn.attention.AttentionAggregationV2.forward" title="Link to this definition"></a></dt>
<dd><p>Forward pass of the attention mechanism.</p>
<p>Parameters:
- key (torch.Tensor): Key vectors.
- value (torch.Tensor): Value vectors.
- query (torch.Tensor): Query vectors.
- edge_weight_cutoff (torch.Tensor): Cutoff weights for edges.
- edge_index (torch.LongTensor): Edge indices.</p>
<p>Returns:
- torch.Tensor: Attended output vectors.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="HamGNN_v_2_1.nn.attention.AttentionAggregation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_1.nn.attention.</span></span><span class="sig-name descname"><span class="pre">AttentionAggregation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_heads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_query</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/HamGNN_v_2_1/nn/attention.html#AttentionAggregation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.nn.attention.AttentionAggregation" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></p>
<p>An equivariant attention mechanism that processes key, value, and query vectors
and applies attention across edges in a graph.</p>
<p>Parameters:
- num_heads (int): Number of attention heads.
- irreps_key (o3.Irreps): Irreducible representations for key vectors.
- irreps_value (o3.Irreps): Irreducible representations for value vectors.
- irreps_query (o3.Irreps): Irreducible representations for query vectors.</p>
<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.nn.attention.AttentionAggregation.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_weight_cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/HamGNN_v_2_1/nn/attention.html#AttentionAggregation.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.nn.attention.AttentionAggregation.forward" title="Link to this definition"></a></dt>
<dd><p>Forward pass of the attention mechanism.</p>
<p>Parameters:
- key (torch.Tensor): Key vectors.
- value (torch.Tensor): Value vectors.
- query (torch.Tensor): Query vectors.
- edge_weight_cutoff (torch.Tensor): Cutoff weights for edges.
- edge_index (torch.LongTensor): Edge indices.</p>
<p>Returns:
- torch.Tensor: Attended output vectors.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="HamGNN_v_2_1.nn.attention.AttentionBlockE3">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_1.nn.attention.</span></span><span class="sig-name descname"><span class="pre">AttentionBlockE3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">irreps_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_node_attrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_edge_feats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_edge_attrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_edge_embed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radial_MLP</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_skip_connections</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_kan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonlinearity_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gate'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonlinearity_scalars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'e':</span> <span class="pre">'ssp',</span> <span class="pre">'o':</span> <span class="pre">'tanh'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonlinearity_gates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'e':</span> <span class="pre">'ssp',</span> <span class="pre">'o':</span> <span class="pre">'abs'}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/HamGNN_v_2_1/nn/attention.html#AttentionBlockE3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.nn.attention.AttentionBlockE3" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></p>
<p>An equivariant attention block for processing graph data with attention mechanisms.</p>
<p>Parameters:
- irreps_in (o3.Irreps): Input irreducible representations.
- irreps_out (o3.Irreps): Output irreducible representations.
- irreps_node_attrs (o3.Irreps): Node attribute irreducible representations.
- irreps_edge_attrs (o3.Irreps): Edge attribute irreducible representations.
- irreps_edge_embed (o3.Irreps): Edge embedding irreducible representations.
- num_heads (int): Number of attention heads.
- max_radius (float): Maximum radius for edge cutoff.
- radial_MLP (Optional[List[int]]): Architecture of the radial MLP.
- use_skip_connections (bool): Whether to use skip connections.
- use_kan (bool): Whether to use KAN for radial MLP.
- nonlinearity_type (str): Type of nonlinearity (‘gate’ or ‘norm’).
- nonlinearity_scalars (Dict[int, Callable]): Scalar nonlinearity functions.
- nonlinearity_gates (Dict[int, Callable]): Gate nonlinearity functions.</p>
<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.nn.attention.AttentionBlockE3.create_linear">
<span class="sig-name descname"><span class="pre">create_linear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">irreps_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/HamGNN_v_2_1/nn/attention.html#AttentionBlockE3.create_linear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.nn.attention.AttentionBlockE3.create_linear" title="Link to this definition"></a></dt>
<dd><p>Create a linear layer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.nn.attention.AttentionBlockE3.create_tensor_product">
<span class="sig-name descname"><span class="pre">create_tensor_product</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">irreps_mid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instructions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/HamGNN_v_2_1/nn/attention.html#AttentionBlockE3.create_tensor_product"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.nn.attention.AttentionBlockE3.create_tensor_product" title="Link to this definition"></a></dt>
<dd><p>Create a TensorProduct layer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.nn.attention.AttentionBlockE3.init_weight_generator">
<span class="sig-name descname"><span class="pre">init_weight_generator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_numel</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/HamGNN_v_2_1/nn/attention.html#AttentionBlockE3.init_weight_generator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.nn.attention.AttentionBlockE3.init_weight_generator" title="Link to this definition"></a></dt>
<dd><p>Initialize weight generator.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.nn.attention.AttentionBlockE3.create_nonlinearity">
<span class="sig-name descname"><span class="pre">create_nonlinearity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nonlinearity_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonlinearity_scalars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonlinearity_gates</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/HamGNN_v_2_1/nn/attention.html#AttentionBlockE3.create_nonlinearity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.nn.attention.AttentionBlockE3.create_nonlinearity" title="Link to this definition"></a></dt>
<dd><p>Create nonlinearity module.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.nn.attention.AttentionBlockE3.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/HamGNN_v_2_1/nn/attention.html#AttentionBlockE3.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.nn.attention.AttentionBlockE3.forward" title="Link to this definition"></a></dt>
<dd><p>Forward pass of the attention block.</p>
<p>Parameters:
- data (Dict[str, torch.Tensor]): A dictionary containing the graph data.</p>
<p>Returns:
- Tuple[torch.Tensor, Optional[torch.Tensor]]: Updated node features and skip connection.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]]</span></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-HamGNN_v_2_1.nn.attention_utils">
<span id="attention-utilities"></span><h2>Attention Utilities<a class="headerlink" href="#module-HamGNN_v_2_1.nn.attention_utils" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="HamGNN_v_2_1.nn.attention_utils.VectorToAttentionHeads">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_1.nn.attention_utils.</span></span><span class="sig-name descname"><span class="pre">VectorToAttentionHeads</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">irreps_head</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/HamGNN_v_2_1/nn/attention_utils.html#VectorToAttentionHeads"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.nn.attention_utils.VectorToAttentionHeads" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></p>
<p>Reshapes vectors of shape [N, irreps_mid] to vectors of shape [N, num_heads, irreps_head].</p>
<p>Attributes:
- num_heads (int): Number of attention heads.
- irreps_head (o3.Irreps): Irreps of each head.
- irreps_mid_in (o3.Irreps): Intermediate irreps.
- mid_in_indices (List[Tuple[int, int]]): Indices for reshaping.</p>
<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.nn.attention_utils.VectorToAttentionHeads.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/HamGNN_v_2_1/nn/attention_utils.html#VectorToAttentionHeads.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.nn.attention_utils.VectorToAttentionHeads.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.
:rtype: <span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="HamGNN_v_2_1.nn.attention_utils.AttentionHeadsToVector">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_1.nn.attention_utils.</span></span><span class="sig-name descname"><span class="pre">AttentionHeadsToVector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">irreps_head</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/HamGNN_v_2_1/nn/attention_utils.html#AttentionHeadsToVector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.nn.attention_utils.AttentionHeadsToVector" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></p>
<p>Converts vectors of shape [N, num_heads, irreps_head] into vectors of shape [N, irreps_head * num_heads].</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="HamGNN_v_2_1.nn.attention_utils.AttentionHeadsToVector.irreps_head">
<span class="sig-name descname"><span class="pre">irreps_head</span></span><a class="headerlink" href="#HamGNN_v_2_1.nn.attention_utils.AttentionHeadsToVector.irreps_head" title="Link to this definition"></a></dt>
<dd><p>A list of irreducible representations (irreps) that define
the structure of the attention heads.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>o3.Irreps</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="HamGNN_v_2_1.nn.attention_utils.AttentionHeadsToVector.head_sizes">
<span class="sig-name descname"><span class="pre">head_sizes</span></span><a class="headerlink" href="#HamGNN_v_2_1.nn.attention_utils.AttentionHeadsToVector.head_sizes" title="Link to this definition"></a></dt>
<dd><p>A list of sizes for each attention head, derived from the irreps.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_1.nn.attention_utils.AttentionHeadsToVector.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/HamGNN_v_2_1/nn/attention_utils.html#AttentionHeadsToVector.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#HamGNN_v_2_1.nn.attention_utils.AttentionHeadsToVector.forward" title="Link to this definition"></a></dt>
<dd><p>Forward pass to process the attention heads and flatten them into a single vector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – Input tensor of shape (N, num_heads, input_dim), where:
- N is the batch size.
- num_heads is the number of attention heads.
- input_dim is the total size of all heads.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Output tensor of shape (N, flattened_dim), where <cite>flattened_dim</cite></dt><dd><p>is the sum of the dimensions of all attention heads.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)">torch.Tensor</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If the sum of <cite>head_sizes</cite> does not match <cite>input_dim</cite> of the input tensor.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="message_passing.html" class="btn btn-neutral float-left" title="Message Passing" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="convolution.html" class="btn btn-neutral float-right" title="Convolution Layers" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright HamGNN Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"></span>
    docs | v2.1 | en
    <span class="fa fa-caret-down"></span>
  </span>
  
  <div class="rst-other-versions">
    
    
    
    
    
    
    
    

    <hr>
    <dl>
      <dt>项目主页</dt>
      <dd>
        <a href="https://github.com/bud-primordium/HamGNN">
          <span class="fa fa-github"></span> GitHub
        </a>
      </dd>
    </dl>
  </div>
</div>

<style>
/* 自定义样式优化三维切换器 */
.rst-versions {
  font-size: 14px;
}

/* 让版本切换器更醒目 */
.rst-current-version {
  background-color: #2c3e50 !important;
  font-weight: bold !important;
  font-size: 15px !important;
  padding: 12px 24px !important;
}

.rst-current-version:hover {
  background-color: #34495e !important;
}

.rst-other-versions dl {
  margin-bottom: 16px;
}

.rst-other-versions dt {
  color: #55a5d9;
  font-weight: bold;
  margin-bottom: 8px;
}

.rst-other-versions dd {
  margin-left: 16px;
  margin-bottom: 4px;
}

.rst-other-versions dd.rtd-current-item a {
  font-weight: bold;
  color: #55a5d9;
}

.rst-other-versions hr {
  margin: 16px 0;
  border: none;
  border-top: 1px solid #444;
}
</style><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>